---
# cmd /C C:/PROGRA~2/MICROS~1/Edge/APPLIC~1/msedge_proxy.exe --app=https://github.com/mkim0710/tidystat/blob/master/rstudio-prefs/templates/templates-00env1.minimum.Rmd
# https://forum.posit.co/t/when-to-use-yaml-vs-when-to-use-setup-code-chunk/56169/
title: "`r params$doc_title`"
author: "MHKim"
date: "`r Sys.setlocale('LC_ALL', 'en_US.utf8'); format(Sys.time(), '%B %d, %Y')`"
output:
  html_notebook:  
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: false
      smooth_scroll: false
    number_sections: false
    code_folding: none
    df_print: tibble
    highlight: textmate
    fig_width: 10
    fig_height: 6
  html_document:
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: false
      smooth_scroll: false
    number_sections: false
    df_print: tibble
    code_folding: none
    highlight: textmate
    fig_width: 10
    fig_height: 6
  pdf_document: 
    toc: yes
    toc_depth: 6
    fig_width: 10
    fig_height: 6
    latex_engine: xelatex  # mainfont, sansfont, monofont, mathfont works only with xelatex and lualatex, but not pdflatex
    keep_tex: true
  word_document:
    toc: yes
    toc_depth: 6
    fig_width: 9
    fig_height: 6
# documentclass: scrartcl  # https://pandoc.org/MANUAL.html#variables-for-latex
# classoption: fontsize=9pt 
geometry: portrait, a3paper, margin=20mm # https://bookdown.org/yihui/rmarkdown/pdf-document.html#latex-options
# fontsize: 12pt
header-includes: 
  - \usepackage{fontspec}
  - \newcommand{\setfallbackfont}[4]{
      \IfFontExistsTF{#2}
        {#1{#2}}
        {\IfFontExistsTF{#3}
          {#1{#3}}
          {#1{#4}}}}
  # - \setfallbackfont{\setmainfont}{Roboto Condensed}{Noto Sans Condensed}{Arial Narrow}
  # - \setfallbackfont{\setsansfont}{Roboto Condensed}{Noto Sans Condensed}{Arial Narrow}
  - \setfallbackfont{\setmainfont}{Roboto}{Noto Sans}{Arial}
  - \setfallbackfont{\setsansfont}{Roboto}{Noto Sans}{Arial}
  - \setfallbackfont{\setmonofont}{Cascadia Code SemiBold}{Cascadia Code}{Fira Code}
  - \usepackage[hangul]{kotex}
  # - \setfallbackfont{\setmainhangulfont}{NanumGothic}{HCR Dotum LVT}{Malgun Gothic}
  # - \setfallbackfont{\setsanshangulfont}{NanumGothic}{HCR Dotum LVT}{Malgun Gothic}
  # - \setfallbackfont{\setmonohangulfont}{D2Coding}{NanumGothicCoding}{NanumGothic}
params:
  doc_title: !r basename(rstudioapi::getSourceEditorContext()$path)
# https://stackoverflow.com/questions/55751815/r-markdown-difference-between-parameters-and-variables
# ?rmarkdown::html_document
---
<!-- https://stackoverflow.com/questions/28480625/r-knitr-markown-setting-html-page-width -->
<style type="text/css">
.main-content, .toc {max-width: 785px; margin: 0 auto; font-size: 1rem;} /* A4: 21cm x 29.7cm = 8.27in x 11.69in; 8.27in x 96px/in ≈ 793px */
html { font-size: 12px; }
body { font-size: 12px; font-family: 'Roboto Condensed', 'Noto Sans Condensed', 'Open Sans Condensed', 'Source Sans 3', 'Arial Narrow', Helvetica, sans-serif; }
h1.title { font-size: 28px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 14px; margin-bottom: 0; color: Navy; }
h1 { font-size: 24px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 12px; margin-bottom: 0; color: Navy; }
h2 { font-size: 21px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 11px; margin-bottom: 0; color: Navy; }
h3 { font-size: 18px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 9px; margin-bottom: 0; color: Navy; }
h4 { font-size: 16px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 8px; margin-bottom: 0; color: Navy; }
h5 { font-size: 14px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 7px; margin-bottom: 0; color: Navy; }
h6 { font-size: 12px; font-family: 'Roboto Serif', 'Noto Serif', 'Source Serif 4', serif; line-height: 1.1; margin-top: 6px; margin-bottom: 0; color: Navy; }
table, td, th, figure, figcaption { font-size: 10px; font-family: 'Roboto Condensed', 'Noto Sans Condensed', 'Open Sans Condensed', 'Source Sans 3', 'Arial Narrow', Helvetica, sans-serif; line-height: 1.1; margin-top: 5px; margin-bottom: 0; }
code { font-size: 11px; font-family: 'Cascadia Code SemiBold', 'Cascadia Code', 'Fira Code', Consolas, 'Source Code Pro', monospace; line-height: 1.1; margin-top: 6px; margin-bottom: 0; color: DimGray; background-color: Snow; }
pre { font-size: 11px; font-family: 'Cascadia Code SemiBold', 'Cascadia Code', 'Fira Code', Consolas, 'Source Code Pro', monospace; line-height: 1.1; margin-top: 6px; margin-bottom: 0; color: DimGray; background-color: Snow; }
</style>
  
<!-- font-size: 0.9em; /* 90% of inherited font size */ -->
  
<!-- Body text (body): The default font size is typically 16 pixels. -->
<!-- Paragraphs (p): Inherit the body's font size, so also typically 16 pixels. -->
<!-- List items (li): Inherit the body's font size, generally 16 pixels. -->
<!-- Headings (h1 to h6): The default sizes decrease with each level. For example: -->
<!-- h1: Typically around 32 pixels. -->
<!-- h2: Often around 24 pixels. -->
<!-- h3: Commonly around 18.72 pixels. -->
<!-- h4: Usually about 16 pixels. -->
<!-- h5: Generally around 13.28 pixels. -->
<!-- h6: Often about 10.72 pixels. -->
<!-- Blockquotes (blockquote): Usually inherit the body's font size, around 16 pixels. -->
<!-- Tables (table), table cells (td, th): Typically inherit the body's font size, so around 16 pixels. -->
<!-- Figures (figure) and figure captions (figcaption): Generally inherit the body's font size, so about 16 pixels. -->
<!-- 1: Approximately 8 pixels. -->
<!-- 2: Approximately 10 pixels. -->
<!-- 3: Approximately 12 pixels (this was often considered the default size). -->
<!-- 4: Approximately 14 pixels. -->
<!-- 5: Approximately 18 pixels. -->
<!-- 6: Approximately 24 pixels. -->
# __________|------  
<!-- {r Rstudio-RMarkDown-Shortcuts, eval=FALSE, include=FALSE} -->
<!-- ##### Rstudio RMarkDown Shortcuts -->
<!-- https://support.posit.co/hc/en-us/articles/200711853-Keyboard-Shortcuts-in-the-RStudio-IDE   -->
<!-- https://bookdown.org/yihui/rmarkdown-cookbook/rstudio-shortcuts.html   -->
<!-- Insert R chunk	Ctrl+Alt+I	Command+Option+I   -->
<!-- Preview HTML	Ctrl+Shift+K	Command+Shift+K   -->
<!-- Run all chunks above	Ctrl+Alt+P	Command+Option+P   -->
<!-- Run current chunk	Ctrl+Alt+C	Command+Option+C   -->
<!-- Run current chunk	Ctrl+Shift+Enter	Command+Shift+Enter   -->
<!-- Run next chunk	Ctrl+Alt+N	Command+Option+N   -->
<!-- Run all chunks	Ctrl+Alt+R	Command+Option+R   -->
<!-- Go to next chunk/title	Ctrl+PgDown	Command+PgDown   -->
<!-- Go to previous chunk/title	Ctrl+PgUp	Command+PgUp   -->
<!-- Show/hide document outline	Ctrl+Shift+O	Command+Shift+O   -->
<!-- F7 spell-check your document.   -->
<!-- Restart the R session   Ctrl + Alt + F10 (or Command + Option + F10 on macOS).   -->
<!--    -->
<!-- *** Caution: @ # \$ \% * \\ ***  -->

  
```{r setup, echo=FALSE, results="hide"}
## Cf) {r setup, eval=TRUE, include=FALSE}
if(Sys.info()["sysname"] == "Windows") Sys.setlocale("LC_ALL", "en_US.UTF-8")  # Note that setting category "LC_ALL" sets only categories "LC_COLLATE", "LC_CTYPE", "LC_MONETARY" and "LC_TIME".
# Sys.setlocale("LC_MESSAGES", "en_US.utf8")  # Note that the LANGUAGE environment variable has precedence over "LC_MESSAGES" in selecting the language for message translation on most R platforms.  # LC_MESSAGES does not exist in Windows
Sys.setenv(LANGUAGE="en_US");  # Sys.getenv("LANGUAGE");    # Note that the LANGUAGE environment variable has precedence over "LC_MESSAGES" in selecting the language for message translation on most R platforms.
# str(knitr::opts_chunk$get())
# cat(deparse(knitr::opts_chunk$get(), width.cutoff=120), "  \n", sep="")
# list(eval=TRUE, echo=TRUE, results = "markup", tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = "##",     highlight = TRUE, size = "normalsize", background = "#F7F7F7", strip.white = structure(TRUE, class = "AsIs"), cache = FALSE,     cache.path = "cache/", cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, autodep = FALSE, cache.rebuild = FALSE,     fig.keep = "high", fig.show = "asis", fig.align = "default", fig.path = "figure/", dev = NULL, dev.args = NULL, dpi = 72,     fig.ext = NULL, fig.width=7, fig.height=7, fig.env = "figure", fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:",     fig.subcap = NULL, fig.pos = "", out.width=NULL, out.height=NULL, out.extra = NULL, fig.retina = 1, external = TRUE,     sanitize = FALSE, interval = 1, aniopts = "controls,loop", warning = TRUE, error = TRUE, message = TRUE, render = NULL,     ref.label = NULL, child = NULL, engine = "R", split = FALSE, include = TRUE, purl = TRUE)
knitr::opts_chunk$set(
    eval=TRUE, echo=FALSE, results="markup", collapse=TRUE, # In Rstudio Notebook Source Pane & nb.HTML, results="hold" does not work
    comment="#", fig.width=10, fig.height=6, # In Rstudio Notebook Source Pane & nb.HTML, comment="##" does not work?
    warning=TRUE, message=TRUE, include=TRUE, 
    error=FALSE,  # error=TRUE: show the errors without stopping R; error=FALSE: stop on error
    tidy.opts=list(width.cutoff=120), tidy=FALSE, 
    R.options = list(width=120), paged.print=FALSE
) 
# knitr::opts_chunk$set(message=TRUE) & {r, results="hide"} -> message shown in Rstudio Notebook Source Pane & knitted HTML, but not in Preview nb.HTML?!
# knitr::opts_chunk$set(message=FALSE) & {r, message=TRUE, results="hide"} -> message shown in Rstudio Notebook Source Pane & knitted HTML, but not in Preview nb.HTML?!
# *** results="hide": results shown only on Rstudio Notebook Source Pane, but not in nb.HTML nor knitted HTML
knitr::opts_knit$set(global.par = TRUE)


## Cf) {r loadPackages-NoEchoHideResults, echo=FALSE, results="hide"}
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
# cmd /C C:/PROGRA~2/MICROS~1/Edge/APPLIC~1/msedge_proxy.exe --app=https://github.com/mkim0710/tidystat/blob/master/rstudio-prefs/templates/default.R
# cmd /C C:/PROGRA~2/MICROS~1/Edge/APPLIC~1/msedge_proxy.exe --app=https://github.com/mkim0710/tidystat/blob/master/rstudio-prefs/templates/templates-00env1.minimum.Rmd
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
# cmd /C C:/PROGRA~2/MICROS~1/Edge/APPLIC~1/msedge_proxy.exe --app=https://github.com/mkim0710/tidystat/blob/master/.Rprofile    
#| ------------------------- < To be covered at .Rprofile > --------------------- |#  
if(!exists("env1", envir=.GlobalEnv)) {  message('> source("https://raw.githubusercontent.com/mkim0710/tidystat/master/.Rprofile")')  ;  source("https://raw.githubusercontent.com/mkim0710/tidystat/master/.Rprofile")  ;  .First()  }  
if(!".Rprofile" %in% names(.GlobalEnv$env1$source)) {  message('> source("https://raw.githubusercontent.com/mkim0710/tidystat/master/.Rprofile")')  ;  source("https://raw.githubusercontent.com/mkim0710/tidystat/master/.Rprofile")  ;  .First()  }  
##________________________________________________________________________________  
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
env1$info$options.width = getOption("width"); cat('\tgetOption("width") == ', env1$info$options.width, "  \n", sep="")
#   
## Cf) {r env1-Info-NoEchoHideResults, echo=FALSE, results="hide"}
# https://yihui.org/knitr/options/#package-options
env1$info$info_software_versions = env1$env.internal.attach$get_software_versions(library_names = c("tidyverse", "dplyr", "ggplot2", "purrr", "stringr", "stats","survival"))
# str(env1$info$info_software_versions)


###### env1\$info\$DocumentTitle1 ----  
# ```{r env1-DocumentTitle1-NoEchoHideResults, echo=FALSE, results="hide"}
env1$info$DocumentTitle0 = paste0("00env1.minimum","-",basename(getwd()))
env1$info$DocumentTitle1 = paste0(env1$info$DocumentTitle0,"@", ifelse(grepl("MacBook-Pro", Sys.info()["nodename"]), "MBP", Sys.info()["nodename"]))
cat(env1$info$DocumentTitle0,"-",format(Sys.time(),"%y%m%d"), "\n", 
    env1$info$DocumentTitle0,"-",format(Sys.time(),"%y%m%d"),".Rmd", "\n", 
    env1$info$DocumentTitle0,"-dev",format(Sys.time(),"%y%m%d"),".Rmd", "\n", 
    env1$info$DocumentTitle0,"-clean",format(Sys.time(),"%y%m%d"),".Rmd", "\n", 
    sep="")
```
  
  
```{r env1-Path-NoEchoNoMsgNoResults, echo=FALSE, warning=TRUE, message=NA, results="hide"}
###### env1\$path ----  
# cat(" getwd() == "); dput(getwd())  
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
### env1\$path\$LastSourceEditorContext.path_filename_ext ====  
# *** Caution) In Rstudio Notebook, the path of the running Rmd file is set as the working directory~!!!
# env1$path$LastSourceEditorContext.path_filename_ext = rstudioapi::getSourceEditorContext()$path |> normalizePath(winslash="/",mustWork=NA) |> str_replace(fixed(getwd()|>normalizePath(winslash="/",mustWork=NA)), "") |> str_replace("^/", "")
# env1$path$LastSourceEditorContext.path_filename_ext = rstudioapi::getSourceEditorContext()$path |> normalizePath(winslash="/",mustWork=NA) |> str_replace(fixed(env1$path$path1|>normalizePath(winslash="/",mustWork=NA)), "") |> str_replace("^/", "")
env1$path$LastSourceEditorContext.path_filename_ext = rstudioapi::getSourceEditorContext()$path |> normalizePath(winslash="/",mustWork=NA)    # Caution) Not using a relative path~!
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
# env1$path$project_base = "Rproject_HEALS0215"
# env1$path$data_suffix = "_01"
# # env1$path$data_suffix = ""
# env1$path$project_suffix = "GJ3"
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
# env1$path$.path4read = file.path(env1$path$path0, paste0(env1$path$project_base, env1$path$data_suffix))
# env1$path$.path4write = file.path(env1$path$.path4read, paste0(env1$path$project_base, env1$path$data_suffix, env1$path$project_suffix))
env1$path$.path4read = ifelse(is.na(env1$path$path1), getwd(), env1$path$path1)
env1$path$.path4write = getwd()
.path4read  = env1$path$.path4read
.path4write = env1$path$.path4write
# cat(" > str(env1$path)\n"); str(env1$path, max.level = 1, give.attr = F)  

## @ env1 |> as.list() |> str(max.level = 2, give.attr = FALSE) ----  
"ls(all.names = TRUE, envir = .GlobalEnv) |> set_names() |> map(get) |> str(max.level = 1, give.attr = FALSE)" |> env1$f$f_CodeText.ECHO(EXECUTE = TRUE, deparse_cat = FALSE, LinePrefix4CodeText = "> ", LinePrefix4Output = "")
cat("    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    \n")
".tmp |> str(max.level = 1, give.attr = FALSE)" |> env1$f$f_CodeText.ECHO(EXECUTE = TRUE, deparse_cat = FALSE, LinePrefix4CodeText = "> ", LinePrefix4Output = "")
cat("    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    \n")
"env1 |> as.list() |> env1$f$f_list.str_by_element(max.level = 2, give.attr = FALSE)" |> env1$f$f_CodeText.ECHO(EXECUTE = TRUE, deparse_cat = FALSE, LinePrefix4CodeText = "> ", LinePrefix4Output = "")
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
# .filename.source.r = "f_DSN.Search.read.checkEntity" |> paste0(".source.r"); .relative.subpath=r"()"|>str_replace_all("\\\\","/"); env1$f$f_sourcePath.execute_if_not_sourced(.relative.subpath_filename.source.r = paste0(.relative.subpath,ifelse(.relative.subpath=="","","/"),.filename.source.r))
# if (getwd() != .path4write) warning("getwd() != .path4write  == ") else cat(" getwd() == .path4write == "); dput(.path4write)  
```
  
  
  
  
# __________|------  
# @@ REFERENCES) ----  
###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```
  
  
# __________|------  
# @@ DATA) example ----  
## dir(all.files = TRUE)  ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

env1$path$path1 %>% dir(all.files = TRUE) %>% dput.deparse.cat0()
# c("-BACKUP", "-info", "-MAGB760M13700KF-3.Rhistory", "-MAGB760M13700KF-4.Rhistory", "-MAGB760M13700KF-5.Rhistory", "-Min-Hyung’s MacBook Pro.Rhistory", "-MKIM-15ZD980-HX70K.Rhistory", "-private-old", "-private - Shortcut.lnk", "-tmp", "-void", "%AppData%Microsoft_Windows_Start Menu_Programs_Startup.lnk", "%OneDriveConsumer%[][Rproject].lnk", "%OneDriveConsumer%[][Rproject]_github_tidystat.lnk", "%OneDriveConsumer%[][Rproject]_github_tidystat_git.lnk", "%OneDriveConsumer%[][Rproject]_github_tidystat_rstudio-prefs.lnk", "%OneDriveConsumer%[][Rproject]_github_tidystat_rstudio-prefs_templates.lnk", "%OneDriveConsumer%[][Rproject]_github_tidystat_rstudio-prefs_VScode-R.lnk", "%OneDriveConsumer%[][Rproject]_Rproject_Rmd.lnk", "%OneDriveConsumer%MHShell.lnk", "%OneDriveConsumer%MHShell_MHdocker.lnk", ".", "..", ".git", ".git.zip", ".gitattributes", ".gitattributes.xz", ".gitattributes@%userProfile% - Shortcut.lnk", ".gitconfig@%userProfile% - Shortcut.lnk", ".gitignore", ".gitignore - Shortcut.lnk", ".gitignore & .git_hooks_pre-commit & .Rprofile -update.r", ".gitignore.xz", ".gitignore@%UserProfile% - Shortcut.lnk", ".gitignore@github_tidystat - Shortcut.lnk", ".gitignore@Rproject_Rmd - Shortcut.lnk", ".lfs.gitattributes", ".non_lfs.gitattributes", ".Rhistory", ".Rprofile", ".Rprofile.debug.log.txt", ".Rprofile.dev.r", ".Rprofile.README.txt", ".Rprofile.xz", ".Rproj.user", ".vscode", "[[Stat]] CRAN R - Shortcut.lnk", "[][Rproject]-private - Shortcut.lnk", "[][Rproject] - Shortcut (2).lnk", "[][Rproject] - Shortcut (3).lnk", "[][Rproject] - Shortcut.lnk", "[][Rproject].code-workspace - Shortcut.lnk", "[Pending Files List] github_tidystat.r", "[Rproj] github_tidystat.Rproj.7z", "[Working Files List] github_tidystat.r", "_--date=local --name-statusgit log --since=.zip", "_.git_hooks_pre-commit - Shortcut.lnk", "_git_hooks_pre-commit - Shortcut.lnk", "01df_dirs_recursive.df_files-github_tidystat.Rmd", "D_Repositories-Shortcut.lnk", "D_Repositories_github_tidystat-BatchRun.ffs_batch.zip", "D_Repositories_github_tidystat-Shortcut.lnk", "D_Repositories_github_tidystat.Rproj", "D_Repositories_github_tidystat.Rproj-Shortcut.lnk", "D_Repositories_tidystat_Rmd_KoGES_AA10030-BatchRun.ffs_batch", "D_Repositories_tidystat_Rmd_KoGES_AA10030-BatchRun.ffs_gui", "D_Repositories_tidystat_Rmd_KoGES_AA10030-BatchRun.ffs_real", "D_Repositories_tidystat_Rmd_KoGES_AA10030-BatchRun.ffs_real@RealTimeSync.exe.lnk", "data", "default.symlink.R", "docker run -d -p --restart=always --name -e -v -private.ps1 - Shortcut (2).lnk", "docker run -d -p --restart=always --name -e -v -private.ps1 - Shortcut.lnk", "env1$env.internal.dev -archive.r.xz", "env1$env.internal.source.r", "f.updateTemplates.dev.Rmd", "f.updateTemplates.exe.r", "f_df.t.tribble_construct.dev.r", "f_df.t.tribble_construct.source.r", "f_df.tribble_construct.source.r.zip", "f_DSN.read.checkEntity.dev.r", "f_DSN.read.checkEntity.dev.Rmd", "f_DSN.Search.read.checkEntity.dev.r", "f_DSN.Search.read.checkEntity.source.r", "f_filename_ext.find_subpath.debugging.r", "f_filename_ext.find_subpath.dev.r", "f_filename_ext.find_subpath.source.r", "f_password.encrypt.dev-private.r - Shortcut.lnk", "f_password.environment.dev-private.r - Shortcut.lnk", "f_path.df_dirs_recursive.df_files.dev -tmp.zip", "f_path.df_dirs_recursive.df_files.dev.r", "f_path.df_dirs_recursive.df_files.source.r", "f_path.list_subpath.dev.r", "f_path.list_subpath.source.r", "git", "github_tidystat - Shortcut.lnk", "github_tidystat (rv433-github_tidystat-58723-restart).code-workspace", "github_tidystat.code-workspace", "github_tidystat.Rproj alias", "github_tidystat_rstudio-prefs_Rocker - Shortcut.lnk", "MH0000 Get-ChildItem -Path $folderPath -File Where-Object $documentExtensions -contains.bat-Shortcut.lnk", "MH0000 Get-ChildItem -Path $folderPath -File Where-Object $Rcode_Extensions -contains.bat-Shortcut.lnk", "MHdocker - Shortcut.lnk", "ProjectDocuments", "Rdev", "README.md", "Removing sensitive data from a repository.url", "Rocker_minimum - Shortcut.lnk", "Rproject_Rmd - Shortcut.lnk", "Rproject_Rmd_00env1-Rproject_Rmd.Rmd - Shortcut (2).lnk", "Rproject_Rmd_00env1-Rproject_Rmd.Rmd - Shortcut.lnk", "Rproject_Rmd_01df_dirs_recursive.df_files-Rproject_Rmd.Rmd - Shortcut (2).lnk", "Rproject_Rmd_01df_dirs_recursive.df_files-Rproject_Rmd.Rmd - Shortcut.lnk", "Rproject_Rmd_20DS.NR.lbl_pending.fct.Rmd - Shortcut (2).lnk", "Rproject_Rmd_20DS.NR.lbl_pending.fct.Rmd - Shortcut.lnk", "Rproject_Rmd_templates-00env1.minimum.Rmd - Shortcut (2).lnk", "Rproject_Rmd_templates-00env1.minimum.Rmd - Shortcut.lnk", "rstudio-prefs", "RStudio.Cloud-setup-void.r", "RStudio.Cloud set up-Min-Hyung’s MacBook Pro.zip", "RStudio.cloud.Rproj", "RStudioServer-setup-old2409.r", "RStudioServer-setup-old241022.r", "RStudioServer-setup.r", "RStudioServer-setup.r - Shortcut (2).lnk", "RStudioServer-setup.r - Shortcut.lnk", "sudo apt-get install openssh-client.sh", "sync.ffs_db", "templates-00env1.minimum.symlink.Rmd", "VScode R settings.txt - Shortcut.lnk", "VScode Replace r files (for pipe).R - Shortcut.lnk", "VScode Replace r files.R - Shortcut.lnk", "VScode Replace Rmd files) codes (for pipes).R - Shortcut.lnk", "VScode Replace Rmd files) codes.R - Shortcut.lnk", "VScode Replace Rmd files) MarkDown.MD - Shortcut.lnk", "VScode Replace Rmd files) opts_chunk.R - Shortcut.lnk", "VScodeSearchRegEx@MHpython - Shortcut (2).lnk", "VScodeSearchRegEx@MHpython - Shortcut (3).lnk", "VScodeSearchRegEx@MHpython - Shortcut.lnk")  
```
  
  
# __________|------  
# @@ START) dev ----  
```{r env0-NoEchoNoResults, echo=FALSE, results="hide"}
env0 = env1
```
  
  
## dir() |> file.info() |> rownames_to_column("FileName") |> str() ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

# dir() |> file.info() |> str()
dir() |> file.info() %>% dimnames() %>% str
dir() |> file.info() |> rownames_to_column("filename_ext") |> str()
dir(full.names = TRUE) |> file.info() |> rownames_to_column("path_file") |> str()
# > dir() |> file.info() %>% dimnames() %>% str
# List of 2
#  $ : chr [1:33] "f_file.encrypt_hybrid.dev.r" "f_file.git_lfs_track_add_f.dev.r" "f_file.remove.dev.r" "f_file.switch_open.dev.r" ...
#  $ : chr [1:7] "size" "isdir" "mode" "mtime" ...
# > dir() |> file.info() |> rownames_to_column("filename_ext") |> str()
# 'data.frame':	33 obs. of  8 variables:
#  $ filename_ext: chr  "f_file.encrypt_hybrid.dev.r" "f_file.git_lfs_track_add_f.dev.r" "f_file.remove.dev.r" "f_file.switch_open.dev.r" ...
#  $ size        : num  10061 4358 11012 554 15952 ...
#  $ isdir       : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ mode        : 'octmode' int  666 666 666 666 666 666 666 666 666 666 ...
#  $ mtime       : POSIXct, format: "2024-11-11 17:41:43" "2024-10-28 01:10:41" "2024-11-23 23:02:20" "2024-11-23 11:47:54" ...
#  $ ctime       : POSIXct, format: "2024-10-28 01:10:41" "2024-10-28 01:10:41" "2024-11-23 23:02:20" "2024-10-28 01:10:41" ...
#  $ atime       : POSIXct, format: "2024-11-11 17:41:43" "2024-10-28 08:13:33" "2024-11-23 23:02:20" "2024-11-23 11:47:54" ...
#  $ exe         : chr  "no" "no" "no" "no" ...
# > dir(full.names = TRUE) |> file.info() |> rownames_to_column("path_file") |> str()
# 'data.frame':	33 obs. of  8 variables:
#  $ path_file: chr  "./f_file.encrypt_hybrid.dev.r" "./f_file.git_lfs_track_add_f.dev.r" "./f_file.remove.dev.r" "./f_file.switch_open.dev.r" ...
#  $ size     : num  10061 4358 11012 554 15952 ...
#  $ isdir    : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ mode     : 'octmode' int  666 666 666 666 666 666 666 666 666 666 ...
#  $ mtime    : POSIXct, format: "2024-11-11 17:41:43" "2024-10-28 01:10:41" "2024-11-23 23:02:20" "2024-11-23 11:47:54" ...
#  $ ctime    : POSIXct, format: "2024-10-28 01:10:41" "2024-10-28 01:10:41" "2024-11-23 23:02:20" "2024-10-28 01:10:41" ...
#  $ atime    : POSIXct, format: "2024-11-11 17:41:43" "2024-10-28 08:13:33" "2024-11-23 23:02:20" "2024-11-23 11:47:54" ...
#  $ exe      : chr  "no" "no" "no" "no" ...
```
  
  
###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```
  
  
###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```
  
  
# __________|------  
# @@ SOURCE) ----  
```{r RUN-ALL-CHUNKS-ABOVE, echo=FALSE, results="hide", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)
#| RUN ALL CHUNKS ABOVE: CTRL+ALT+SHIFT+P |#
```


```{r .subpath_filename.source.r-NoEchoNoMsgNoResults, echo=FALSE, warning=TRUE, message=NA, results="hide"}
options(width=120)
options(DEVMODE = TRUE);  # isTRUE(getOption("DEVMODE"))
# .subpath=r"(rstudio-prefs\templates)"|>str_replace_all("\\\\","/")  # Using Raw Strings in R 4.0.0 and Later: The raw string literal, denoted by r"(...)", will not process \ as an escape character.
if(!is.null(env1$path$LastSourceEditorContext.path_filename_ext)) if(env1$path$LastSourceEditorContext.path_filename_ext != "") {.subpath = env1$path$LastSourceEditorContext.path_filename_ext |> dirname(); ".subpath" %>% {cat(.,' = "',get(.),'"  \n', sep="")} }
# if(.subpath!="") utils::browseURL(normalizePath(.subpath))
# .filename.source.r = "default.template" |> paste0(".source.r")
if(!is.null(env1$path$LastSourceEditorContext.path_filename_ext)) if(env1$path$LastSourceEditorContext.path_filename_ext != "") {.sourcename_root = env1$path$LastSourceEditorContext.path_filename_ext |> basename() |> str_replace("\\.(dev|source)\\.(r|Rmd)$"|>regex(ignore_case=TRUE), "") |> str_replace("\\.(r|Rmd)$"|>regex(ignore_case=TRUE),""); ".sourcename_root" %>% {cat(.,' = "',get(.),'"  \n', sep="")} }
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
env1$path$.relative.subpath = .relative.subpath
if(!exists(".sourcename_root") && exists(".filename.source.r")) .sourcename_root = .filename.source.r |> str_replace("\\.source\\.r$", "")
.filename.source.r = .sourcename_root |> paste0(".source.r")
env1$path$.sourcename_root = .sourcename_root
env1$path$.relative.subpath_filename.dev.r = paste0(.relative.subpath,ifelse(.relative.subpath=="","","/"),.sourcename_root,".dev.r")
env1$path$.relative.subpath_filename.dev.Rmd = paste0(.relative.subpath,ifelse(.relative.subpath=="","","/"),.sourcename_root,".dev.Rmd")
env1$path$.relative.subpath_filename.source.r = paste0(.relative.subpath,ifelse(.relative.subpath=="","","/"),.sourcename_root,".source.r")
cat("# ",'.sourcename_root = "',.sourcename_root,'"  \n',
    "#### ",env1$path$.relative.subpath_filename.dev.r, "----  \n",
    "#### ",env1$path$.relative.subpath_filename.dev.Rmd, "----  \n",
    "#### ",env1$path$.relative.subpath_filename.source.r, "----  \n",
    '# # source(paste0(env1$path$source_base,"/","',env1$path$.relative.subpath_filename.source.r,'"))', "  \n",
    '# # if(!file.exists("',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.dev.r,'")) download.file(url = "https://raw.githubusercontent.com/mkim0710/tidystat/master/rstudio-prefs/templates/default.R", destfile = "',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.dev.r,'")', "  \n",
    '# # if(!file.exists("',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.dev.Rmd,'")) download.file(url = "https://raw.githubusercontent.com/mkim0710/tidystat/master/rstudio-prefs/templates/templates-00env1.minimum.Rmd", destfile = "',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.dev.Rmd,'")', "  \n",
    '# # if(!file.exists("',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.source.r,'")) download.file(url = "https://raw.githubusercontent.com/mkim0710/tidystat/master/rstudio-prefs/templates/default.R", destfile = "',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.source.r,'")', "  \n",
    '# file.edit("',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.dev.r,'"); if(!is.null(env1$path$LastSourceEditorContext.path_filename_ext)) if(env1$path$LastSourceEditorContext.path_filename_ext != "") file.edit(paste0(env1$path$path1,"/",env1$path$LastSourceEditorContext.path_filename_ext));', "  \n",
    '# file.edit("',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.dev.Rmd,'"); if(!is.null(env1$path$LastSourceEditorContext.path_filename_ext)) if(env1$path$LastSourceEditorContext.path_filename_ext != "") file.edit(paste0(env1$path$path1,"/",env1$path$LastSourceEditorContext.path_filename_ext));', "  \n",
    '# file.edit("',env1$path$source_base_local,"/",env1$path$.relative.subpath_filename.source.r,'"); if(!is.null(env1$path$LastSourceEditorContext.path_filename_ext)) if(env1$path$LastSourceEditorContext.path_filename_ext != "") file.edit(paste0(env1$path$path1,"/",env1$path$LastSourceEditorContext.path_filename_ext));', "  \n",
    sep="")
# #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
# # \% source( file.path(env1$path$source_base,.subpath_filename.source.r) ) ----  
# env1$f$f_sourcePath.execute_if_not_sourced(.subpath_filename.source.r = paste0(.subpath,ifelse(.subpath=="","","/"),.filename.source.r))
```
  
  
# __________|------  
# @@ START) function ----  
## :: f_path.file.info = function() -dev -pending  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

?list.files
# list.files(path = ".", pattern = NULL, all.files = FALSE,
#            full.names = FALSE, recursive = FALSE,
#            ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)
# 
#        dir(path = ".", pattern = NULL, all.files = FALSE,
#            full.names = FALSE, recursive = FALSE,
#            ignore.case = TRUE, include.dirs = FALSE, no.. = FALSE)

env1$f$f_text_function_arguments.identity_mapping("pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE")
# pattern = pattern, all.files = all.files, full.names = full.names, recursive = recursive, ignore.case = ignore.case, include.dirs = include.dirs, no.. = no..


##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
## ->> Now included in env1$env.internal.source.r ----

##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
## :: f_path.file.info ====
## Rdev/60_communicate_report_export/f_list_df.write_xlsx_table.dev.Rmd
## Rdev/00_base_program/001_base_file/f_path.DOCs_Rcode.file.info.xlsx.dev.Rmd
.tmp$env1_subenv_name = "f"
.tmp$objectname = "f_path.file.info"
env1[[.tmp$env1_subenv_name]][[.tmp$objectname]] = function(
        input_path = ".", pattern = NULL, 
        all.files = FALSE, full.names = TRUE, recursive = ifelse(is.null(pattern), FALSE, TRUE),
        ignore.case = TRUE, include.dirs = TRUE, no.. = TRUE, 
        arrange_by = c("mtime")) {
    library(openxlsx2)
    
    # Check if input_path exists
    if (!dir.exists(input_path)) {
        stop("The specified input_path does not exist.")
    }
    input_path = input_path |> normalizePath(winslash = "/")
    
    # List files in the input_path
    input_path.list.files <- list.files(input_path, pattern = pattern, all.files = all.files, full.names = full.names, recursive = recursive, ignore.case = ignore.case, include.dirs = include.dirs, no.. = no..) 
    
    input_path.list.files.file.info = 
        input_path.list.files |> 
        file.info() |> 
        rownames_to_column("path_file") %>% 
        # select(path_file, size, isdir, mode, mtime, ctime, atime, exe) %>% 
        transmute(
            path_file = path_file
            , path = dirname(path_file) |> as.factor()
            , path.relative = env1$f$f_path.relative(as.character(path)) |> as.factor()
            , filename_ext = basename(path_file)
            , filename = env1$env.internal$f_vec_path.vec_filename_sans_ext_extended(filename_ext)
            , ext = env1$env.internal$f_vec_path.vec_ext_extended(filename_ext) |> as.factor()
            , size = size
            , size_KiB = round(size / 2^10, 2)
            , size_MiB = round(size / 2^20, 2)
            , size_GiB = round(size / 2^30, 2)
            , isdir = isdir
            , mtime = mtime
            , ModifiedDate = as.Date(mtime)
        ) |> arrange(desc(!!sym(arrange_by)))
    input_path.list.files.file.info
}
env1$f$f_path.file.info() %>% str()
# > env1$f$f_path.file.info() %>% str()
# 'data.frame':	39 obs. of  13 variables:
#  $ path_file    : chr  "D:/D_Repositories/github_tidystat/Rdev/00_base_program/001_base_file/~$001_base_file-dir.file.info.xlsx" "D:/D_Repositories/github_tidystat/Rdev/00_base_program/001_base_file/001_base_file-dir.file.info.xlsx" "D:/D_Repositories/github_tidystat/Rdev/00_base_program/001_base_file/f_file.encrypt_hybrid.dev.r" "D:/D_Repositories/github_tidystat/Rdev/00_base_program/001_base_file/f_file.git_lfs_track_add_f.dev.r" ...
#  $ path         : Factor w/ 1 level "D:/D_Repositories/github_tidystat/Rdev/00_base_program/001_base_file": 1 1 1 1 1 1 1 1 1 1 ...
#  $ path.relative: Factor w/ 1 level "Rdev/00_base_program/001_base_file": 1 1 1 1 1 1 1 1 1 1 ...
#  $ filename_ext : chr  "~$001_base_file-dir.file.info.xlsx" "001_base_file-dir.file.info.xlsx" "f_file.encrypt_hybrid.dev.r" "f_file.git_lfs_track_add_f.dev.r" ...
#  $ filename     : chr  "~$001_base_file-dir.file.info" "001_base_file-dir.file.info" "f_file.encrypt_hybrid.dev" "f_file.git_lfs_track_add_f.dev" ...
#  $ ext          : Factor w/ 5 levels "html","r","Rmd",..: 4 4 2 2 2 2 2 2 2 2 ...
#  $ size         : num  165 9651 10061 4358 11012 ...
#  $ size_KiB     : num  0.16 9.42 9.83 4.26 10.75 ...
#  $ size_MiB     : num  0 0.01 0.01 0 0.01 0 0.02 0.01 0.02 0.02 ...
#  $ size_GiB     : num  0 0 0 0 0 0 0 0 0 0 ...
#  $ isdir        : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ mtime        : POSIXct, format: "2024-12-12 01:39:57" "2024-12-12 01:39:55" "2024-11-11 17:41:43" "2024-10-28 01:10:41" ...
#  $ ModifiedDate : Date, format: "2024-12-11" "2024-12-11" "2024-11-11" "2024-10-27" ...
```

### \% |> f_path.file.info()  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

env1$path$path1 |> env1$f$f_path.file.info() %>% str()
# 'data.frame':	136 obs. of  12 variables:
#  $ path_file   : chr  "D:/D_Repositories/github_tidystat/-info" "D:/D_Repositories/github_tidystat/-MAGB760M13700KF-3.Rhistory" "D:/D_Repositories/github_tidystat/-MAGB760M13700KF-4.Rhistory" "D:/D_Repositories/github_tidystat/-MAGB760M13700KF-5.Rhistory" ...
#  $ path        : chr  "D:/D_Repositories/github_tidystat" "D:/D_Repositories/github_tidystat" "D:/D_Repositories/github_tidystat" "D:/D_Repositories/github_tidystat" ...
#  $ filename_ext: chr  "-info" "-MAGB760M13700KF-3.Rhistory" "-MAGB760M13700KF-4.Rhistory" "-MAGB760M13700KF-5.Rhistory" ...
#  $ filename    : chr  "-info" "-MAGB760M13700KF-3" "-MAGB760M13700KF-4" "-MAGB760M13700KF-5" ...
#  $ ext         : chr  "" "Rhistory" "Rhistory" "Rhistory" ...
#  $ size        : num  4096 44773 46221 47010 46944 ...
#  $ size_KiB    : num  4 43.7 45.1 45.9 45.8 ...
#  $ size_MiB    : num  0 0.04 0.04 0.04 0.04 0.04 0.01 0 0 0 ...
#  $ size_GiB    : num  0 0 0 0 0 0 0 0 0 0 ...
#  $ isdir       : logi  TRUE FALSE FALSE FALSE FALSE FALSE ...
#  $ mtime       : POSIXct, format: "2024-10-28 09:09:19" "2024-05-21 02:35:34" "2024-05-23 22:22:49" "2024-06-05 21:16:50" ...
#  $ ModifiedDate: Date, format: "2024-10-28" "2024-05-20" "2024-05-23" "2024-06-05" ...
```
  
  
## :: f_path.file.info.xlsx = function() -dev -pending  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)


##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
## ->> Now included in env1$env.internal.source.r ----

##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
## :: f_path.file.info.xlsx ====
## Rdev/60_communicate_report_export/f_list_df.write_xlsx_table.dev.Rmd
## Rdev/00_base_program/001_base_file/f_path.DOCs_Rcode.file.info.xlsx.dev.Rmd
.tmp$env1_subenv_name = "f"
.tmp$objectname = "f_path.file.info.xlsx"
env1[[.tmp$env1_subenv_name]][[.tmp$objectname]] = function(
        input_path = ".", pattern = NULL, 
        all.files = FALSE, full.names = TRUE, recursive = ifelse(is.null(pattern), FALSE, TRUE),
        ignore.case = TRUE, include.dirs = TRUE, no.. = TRUE,
        arrange_by = c("mtime"), 
        output_filename.xlsx = "FolderName-dir.file.info-YYMMDD.xlsx", overwrite = TRUE, xls.open_or_browseURL = TRUE) {
    
    input_path = input_path |> normalizePath(winslash = "/")
    
    output_filename.xlsx = output_filename.xlsx |> normalizePath(winslash = "/", mustWork = FALSE)
    if (Sys.info()["sysname"] == "Windows") {  output_filename.xlsx = output_filename.xlsx |> str_replace("D:/D_Repositories", paste0(Sys.getenv("OneDriveConsumer"),"/[][Rproject]")|>str_replace_all("\\\\","/"))  }
    if(!dir.exists(dirname(output_filename.xlsx))) {dir.create(dirname(output_filename.xlsx), recursive = TRUE)}
    
    if(output_filename.xlsx %>% str_detect("FolderName")) {
        FolderName = input_path |> basename()
        output_filename.xlsx = output_filename.xlsx %>% str_replace_all(fixed("FolderName"), FolderName)
    }
    Sys.Date.YYMMDD = format(Sys.Date(), "%y%m%d")
    if(output_filename.xlsx %>% str_detect("YYMMDD")) {
        output_filename.xlsx = output_filename.xlsx %>% str_replace_all(fixed("YYMMDD"), Sys.Date.YYMMDD)
    }
    
    if(!overwrite && file.exists(output_filename.xlsx)) {
        paste0("file.exists(",deparse(output_filename.xlsx), ") -> Consider: overwrite = TRUE  \n") |> warning(immediate. = TRUE)
        return(invisible())
    }
    
    input_path.file.info = input_path |> env1$f$f_path.file.info(pattern = pattern, all.files = all.files, full.names = full.names, recursive = recursive, ignore.case = ignore.case, include.dirs = include.dirs, no.. = no.., arrange_by = arrange_by)
    
    # openxlsx2::write_xlsx(input_path.file.info, file = output_filename.xlsx, as_table = TRUE, col_widths = "auto", first_active_row = 2, first_active_col = 4)
    DS = input_path.file.info
    library(openxlsx2)
    wb = openxlsx2::write_xlsx(setNames(list(DS), "file.info"), as_table = TRUE, col_widths = "auto", first_active_row = 2, first_active_col = 5)
    # vec_col_index_to_hide = colnames(DS) %>% str_which(paste0(vec_colnames_to_hide, collapse = "|"))
    # vec_colnames_to_hide <- c("path_file", "path", "filename")
    # vec_col_index_to_hide = which(colnames(DS) %in% vec_colnames_to_hide)
    vec_colnames_to_show = c("path.relative", "filename_ext", "ext", "size_MiB", "isdir", "ModifiedDate")
    vec_col_index_to_hide = which(!colnames(DS) %in% vec_colnames_to_show)
    wb$set_col_widths(sheet = 1, cols = vec_col_index_to_hide, hidden = TRUE)
    wb |> wb_save(output_filename.xlsx)

    if(xls.open_or_browseURL) env1$f$f_file_xls.open_or_browseURL(output_filename.xlsx) else paste0("env1$f$f_file_xls.open_or_browseURL(",deparse(output_filename.xlsx),")  \n") |> message(appendLF = FALSE)
    invisible(input_path.file.info)
}

env1$f$f_path.file.info.xlsx()
```
  
  
## :: f_path.DOCs_Rcode.file.info.xlsx = function() -dev -pending  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)


# ##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# # ->> Now included in env1$env.internal.source.r ----
# 
# ##++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# ## :: f_path.DOCs_Rcode.file.info.xlsx ====
# ## Rdev/60_communicate_report_export/f_list_df.write_xlsx_table.dev.Rmd
# ## Rdev/00_base_program/001_base_file/f_path.DOCs_Rcode.file.info.xlsx.dev.Rmd
# .tmp$env1_subenv_name = "f"
# .tmp$objectname = "f_path.DOCs_Rcode.file.info.xlsx"
# env1[[.tmp$env1_subenv_name]][[.tmp$objectname]] = function(
#         input_path = env1$path$path1,
#         list_DSN_pattern = list(DOCs = "\\.(txt|csv|doc[mx]?|xls[mx]?|ppt[mx]?|pdf|html)$", Rcode = "\\.(r|rmd)$"),
#         all.files = FALSE, full.names = TRUE, recursive = TRUE,
#         ignore.case = TRUE, include.dirs = TRUE, no.. = TRUE,
#         arrange_by = c("mtime"),
#         output_filename.xlsx = paste0(env1$path$path1, "/ProjectDocuments/", "FolderName-DOCs_Rcode.file.info-YYMMDD.xlsx"), overwrite = FALSE, xls.open_or_browseURL = TRUE, orphan_nb_html.remove = TRUE) {
# 
#     library(openxlsx2)
#     input_path = input_path |> normalizePath(winslash = "/")
# 
#     output_filename.xlsx = output_filename.xlsx |> normalizePath(winslash = "/", mustWork = FALSE)
#    if (Sys.info()["sysname"] == "Windows") {  output_filename.xlsx = output_filename.xlsx |> str_replace("D:/D_Repositories", paste0(Sys.getenv("OneDriveConsumer"),"/[][Rproject]")|>str_replace_all("\\\\","/"))  }
#    if(!dir.exists(dirname(output_filename.xlsx))) {dir.create(dirname(output_filename.xlsx), recursive = TRUE)}
# 
#     if(output_filename.xlsx %>% str_detect("FolderName")) {
#         FolderName = input_path |> basename()
#         output_filename.xlsx = output_filename.xlsx %>% str_replace_all(fixed("FolderName"), FolderName)
#     }
#     Sys.Date.YYMMDD = format(Sys.Date(), "%y%m%d")
#     if(output_filename.xlsx %>% str_detect("YYMMDD")) {
#         output_filename.xlsx = output_filename.xlsx %>% str_replace_all(fixed("YYMMDD"), Sys.Date.YYMMDD)
#     }
#     
#     if(!overwrite && file.exists(output_filename.xlsx)) {
#         paste0("file.exists(",deparse(output_filename.xlsx), ") -> Consider: overwrite = TRUE  \n") |> warning(immediate. = TRUE)
#         if(xls.open_or_browseURL) env1$f$f_file_xls.open_or_browseURL(output_filename.xlsx) else paste0("env1$f$f_file_xls.open_or_browseURL(",deparse(output_filename.xlsx),")  \n") |> message(appendLF = FALSE)
#         return(invisible())
#     }
# 
#     wb <- wb_workbook()
# 
# 
#     for (DSN in names(list_DSN_pattern)) {
# 
#         DS = input_path |> env1$f$f_path.file.info(pattern = list_DSN_pattern[[DSN]], all.files = all.files, full.names = full.names, recursive = recursive, ignore.case = ignore.case, include.dirs = include.dirs, no.. = no.., arrange_by = arrange_by)
#         wb$add_worksheet(DSN)
#         wb$add_data_table(sheet = DSN, x = DS, table_name = DSN)
#         wb$set_col_widths(sheet = DSN, cols = 1:ncol(DS), widths = "auto")
#         wb$freeze_pane(sheet = DSN, first_active_row = 2, first_active_col = 5)
#         vec_colnames_to_show = c("path.relative", "filename_ext", "ext", "size_MiB", "isdir", "ModifiedDate")
#         vec_col_index_to_hide = which(!colnames(DS) %in% vec_colnames_to_show)
#         wb$set_col_widths(sheet = DSN, cols = vec_col_index_to_hide, hidden = TRUE)
#     }
# 
#     wb |> wb_save(output_filename.xlsx)
# 
#     if(xls.open_or_browseURL) env1$f$f_file_xls.open_or_browseURL(output_filename.xlsx) else paste0("env1$f$f_file_xls.open_or_browseURL(",deparse(output_filename.xlsx),")  \n") |> message(appendLF = FALSE)
#     invisible()
# }
# 
# env1$f$f_path.DOCs_Rcode.file.info.xlsx(overwrite = TRUE)
```
  
  
## :: f_list_df.write_xlsx_table = function() -dev -pending  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
## :: f_list_df.write_xlsx_table ====
## Rdev/60_communicate_report_export/f_list_df.write_xlsx_table.dev.Rmd
## Rdev/00_base_program/001_base_file/f_path.DOCs_Rcode.file.info.xlsx.dev.Rmd
.tmp$env1_subenv_name = "f"
.tmp$objectname = "f_list_df.write_xlsx_table" 
env1[[.tmp$env1_subenv_name]][[.tmp$objectname]] = function(list_df, output_filename.xlsx, vec_colnames_to_show = NULL, first_active_row = 2, first_active_col = 2, overwrite = FALSE, xls.open_or_browseURL = TRUE) {
    library(openxlsx2)
    
    output_filename.xlsx = output_filename.xlsx |> normalizePath(winslash = "/", mustWork = FALSE)
    if (Sys.info()["sysname"] == "Windows") {  output_filename.xlsx = output_filename.xlsx |> str_replace("D:/D_Repositories", paste0(Sys.getenv("OneDriveConsumer"),"/[][Rproject]")|>str_replace_all("\\\\","/"))  }
    if(!dir.exists(dirname(output_filename.xlsx))) {dir.create(dirname(output_filename.xlsx), recursive = TRUE)}
    
    if(!overwrite && file.exists(output_filename.xlsx)) {
        paste0("file.exists(",deparse(output_filename.xlsx), ") -> Consider: overwrite = TRUE  \n") |> warning(immediate. = TRUE)
        if(xls.open_or_browseURL) env1$f$f_file_xls.open_or_browseURL(output_filename.xlsx) else paste0("env1$f$f_file_xls.open_or_browseURL(",deparse(output_filename.xlsx),")  \n") |> message(appendLF = FALSE)
        return(invisible())
    }
    
    wb <- wb_workbook()
    
    # Add each data.frame to a new worksheet
    for (DSN in names(list_df)) {
        DS <- list_df[[DSN]]
        
        # Add worksheet and data table
        wb$add_worksheet(DSN)
        wb$add_data_table(sheet = DSN, x = DS, table_name = DSN)
        
        # Auto-adjust column widths
        wb$set_col_widths(sheet = DSN, cols = 1:ncol(DS), widths = "auto")
        
        # Freeze panes (optional configuration)
        wb$freeze_pane(sheet = DSN, first_active_row = first_active_row, first_active_col = first_active_col)
        
        # Hide unwanted columns, if specified
        if (!is.null(vec_colnames_to_show)) {
            vec_col_index_to_hide <- which(!colnames(DS) %in% vec_colnames_to_show)
            wb$set_col_widths(sheet = DSN, cols = vec_col_index_to_hide, hidden = TRUE)
        }
    }
    
    wb |> wb_save(output_filename.xlsx)
    
    if(xls.open_or_browseURL) env1$f$f_file_xls.open_or_browseURL(output_filename.xlsx) else paste0("env1$f$f_file_xls.open_or_browseURL(",deparse(output_filename.xlsx),")  \n") |> message(appendLF = FALSE)
    invisible(output_filename.xlsx)
}
```
  
  
## :: f_path.DOCs_Rcode.file.info.xlsx = function() -dev -pending  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)


##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
## ->> Now included in env1$env.internal.source.r ----

##++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  
## :: f_path.DOCs_Rcode.file.info.xlsx ====
## Rdev/60_communicate_report_export/f_list_df.write_xlsx_table.dev.Rmd
## Rdev/00_base_program/001_base_file/f_path.DOCs_Rcode.file.info.xlsx.dev.Rmd
.tmp$env1_subenv_name = "f"
.tmp$objectname = "f_path.DOCs_Rcode.file.info.xlsx"
env1[[.tmp$env1_subenv_name]][[.tmp$objectname]] = function(
        input_path = env1$path$path1, 
        list_DSN_pattern = list(DOCs = "\\.(txt|csv|doc[mx]?|xls[mx]?|ppt[mx]?|pdf|html)$", Rcode = "\\.(r|rmd)$"), 
        all.files = FALSE, full.names = TRUE, recursive = TRUE,
        ignore.case = TRUE, include.dirs = TRUE, no.. = TRUE,
        arrange_by = c("mtime"), 
        output_filename.xlsx = paste0(env1$path$path1, "/ProjectDocuments/", "FolderName-DOCs_Rcode.file.info-YYMMDD.xlsx"), overwrite = FALSE, xls.open_or_browseURL = TRUE, orphan_nb_html.remove = TRUE) { 

    library(openxlsx2)
    input_path = input_path |> normalizePath(winslash = "/")
    
    output_filename.xlsx = output_filename.xlsx |> normalizePath(winslash = "/", mustWork = FALSE)
    if (Sys.info()["sysname"] == "Windows") {  output_filename.xlsx = output_filename.xlsx |> str_replace("D:/D_Repositories", paste0(Sys.getenv("OneDriveConsumer"),"/[][Rproject]")|>str_replace_all("\\\\","/"))  }
    if(!dir.exists(dirname(output_filename.xlsx))) {dir.create(dirname(output_filename.xlsx), recursive = TRUE)}
    
    if(output_filename.xlsx %>% str_detect("FolderName")) {
        FolderName = input_path |> basename()
        output_filename.xlsx = output_filename.xlsx %>% str_replace_all(fixed("FolderName"), FolderName)
    }
    Sys.Date.YYMMDD = format(Sys.Date(), "%y%m%d")
    if(output_filename.xlsx %>% str_detect("YYMMDD")) {
        output_filename.xlsx = output_filename.xlsx %>% str_replace_all(fixed("YYMMDD"), Sys.Date.YYMMDD)
    }
    
    if(!overwrite && file.exists(output_filename.xlsx)) {
        paste0("file.exists(",deparse(output_filename.xlsx), ") -> Consider: overwrite = TRUE  \n") |> warning(immediate. = TRUE)
        if(xls.open_or_browseURL) env1$f$f_file_xls.open_or_browseURL(output_filename.xlsx) else paste0("env1$f$f_file_xls.open_or_browseURL(",deparse(output_filename.xlsx),")  \n") |> message(appendLF = FALSE)
        return(invisible())
    }
    if(orphan_nb_html.remove) env1$f$f_path.list.files_orphan_nb_html.remove(execute = FALSE)
    
    list_df = list_DSN_pattern %>% map(function(pattern) {
        input_path |> env1$f$f_path.file.info(pattern = pattern, all.files = all.files, full.names = full.names, recursive = recursive, ignore.case = ignore.case, include.dirs = include.dirs, no.. = no.., arrange_by = arrange_by)
    }) %>% set_names(paste0(names(list_DSN_pattern),Sys.Date.YYMMDD,"subdirs"))
    
    list_df_path1 = list_DSN_pattern %>% map(function(pattern) {
        input_path |> env1$f$f_path.file.info(pattern = pattern, all.files = all.files, full.names = full.names, recursive = FALSE, ignore.case = ignore.case, include.dirs = include.dirs, no.. = no.., arrange_by = arrange_by)
    }) %>% set_names(paste0(names(list_DSN_pattern),Sys.Date.YYMMDD,"path1"))

    list_df_ProjectDocuments = map2(list_df, list_df_path1, function(df, df_path1) {
        bind_rows(df_path1, df %>% filter(path %>% str_detect("ProjectDocuments"))) |> arrange(desc(!!sym(arrange_by)))
    # }) %>% set_names(paste0(names(list_DSN_pattern),Sys.Date.YYMMDD,"PrjDoc"))
    }) %>% set_names(paste0(names(list_DSN_pattern),Sys.Date.YYMMDD))
    
    env1$f$f_list_df.write_xlsx_table(list_df = c(list_df_ProjectDocuments, list_df), output_filename.xlsx = output_filename.xlsx, vec_colnames_to_show = c("path.relative", "filename_ext", "ext", "size_MiB", "isdir", "ModifiedDate"), first_active_row = 2, first_active_col = 5, overwrite = overwrite, xls.open_or_browseURL = xls.open_or_browseURL)
    
    invisible()
}

env1$f$f_path.DOCs_Rcode.file.info.xlsx(overwrite = TRUE)
```


###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```

  
###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```
  
  
# __________|------  
# @@ END ----  
```{r END-NoEvalNoEchoNoMsgNoResults, eval=FALSE, echo=FALSE, warning=TRUE, message=NA, results="hide", collapse=TRUE, paged.print=FALSE}
##________________________________________________________________________________  
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
##++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
##________________________________________________________________________________  
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
# @@ END ----  
cat("    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::    \n")
cat("    [][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]    \n")
cat("    {}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}{}    \n")
cat("    ()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()    \n")
cat("    <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>    \n")
cat("    HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH    \n")
cat("    OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO    \n")
cat("    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX    \n")
cat("    VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV    \n")
cat("    WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW    \n")
cat("    -|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|    \n")
cat("    ________________________________________________________________________    \n")
cat("    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    \n")
cat("    ************************************************************************    \n")
cat("    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++    \n")
cat("    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    \n")
```
  
  
###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```

  
###### ECHO \% |> () ----  
```{r, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="#", R.options=list(width=120)}
options(width=120)

```

  
  
```{r createBACKUP, eval=TRUE, include=FALSE}
if (Sys.getenv("PARENT_RENDERING") != "YES") {
    # if (Sys.info()["sysname"] == "Windows") {
        env1$env.internal.attach$f_filename_ext.createBACKUP(BACKUP_from_path_filename_ext = rstudioapi::getSourceEditorContext()$path|>str_replace("\\.([[:alnum:]]+)$",".Rmd"), .BACKUP_to_path="-BACKUP", timeFormat="%y%m%d_%H", overwrite=TRUE)
        # env1$env.internal.attach$f_filename_ext.createBACKUP(BACKUP_from_path_filename_ext = rstudioapi::getSourceEditorContext()$path|>str_replace("\\.([[:alnum:]]+)$",".nb.html"), .BACKUP_to_path="-BACKUP", timeFormat="%y%m%d_%H", overwrite=TRUE)
    # }
}
```
  
  
```{r gitCheckout-NoEchoNoMsgNoResults, echo=FALSE, warning=TRUE, message=NA, results="hide"}
env1$source[[basename(rstudioapi::getSourceEditorContext()$path)]] = rstudioapi::getSourceEditorContext()$path
env1$path$LastSourceEditorContext.path_filename.nb.html = env1$path$LastSourceEditorContext.path_filename_ext |> str_replace("\\.([[:alnum:]]+)$",".nb.html")
if (Sys.info()["sysname"] == "Windows" && Sys.getenv("PARENT_RENDERING") != "YES") {  try(  paste0('ping -n 5 127.0.0.1 > nul & "C:/Program Files (x86)/Microsoft/Edge/Application/msedge_proxy.exe" --app="',env1$path$LastSourceEditorContext.path_filename.nb.html %>% {paste0(env1$path$path1,"/",.)}|>normalizePath(winslash="/",mustWork=TRUE),'"') |> shell(wait=FALSE)  )  }  # else { browseURL(env1$path$LastSourceEditorContext.path_filename.nb.html %>% {paste0(env1$path$path1,"/",.)}) }
# paste0("https://github.com/mkim0710/",basename(getwd()),"/blob/main/",env1$path$LastSourceEditorContext.path_filename_ext) %>% paste0('"C:/Program Files (x86)/Microsoft/Edge/Application/msedge_proxy.exe" --app="',.,'"') |> system(intern=TRUE)
paste0("https://github.com/mkim0710/",basename(getwd()),"/blob/main/",env1$path$LastSourceEditorContext.path_filename_ext) %>% paste0('"C:/Program Files (x86)/Microsoft/Edge/Application/msedge_proxy.exe" --app="',.,'"') %>% paste0("'",.,"' |> system(intern=TRUE)") |> cat("  \n", sep="")
# paste0("https://github.com/mkim0710/",basename(getwd()),"/commits/main/",env1$path$LastSourceEditorContext.path_filename_ext) %>% paste0('"C:/Program Files (x86)/Microsoft/Edge/Application/msedge_proxy.exe" --app="',.,'"') |> system(intern=TRUE)
paste0("https://github.com/mkim0710/",basename(getwd()),"/commits/main/",env1$path$LastSourceEditorContext.path_filename_ext)  %>% paste0('"C:/Program Files (x86)/Microsoft/Edge/Application/msedge_proxy.exe" --app="',.,'"') %>% paste0("'",.,"' |> system(intern=TRUE)") |> cat("  \n", sep="")
cat("* To revert to the last commited file, run the following terminal command:  \n")
paste0( "git checkout -- ",shQuote(paste0(env1$path$path1,"/",env1$path$LastSourceEditorContext.path_filename_ext)) ) |> deparse() |> cat(" |> system(intern=TRUE)  \n", sep="")
paste0( "git checkout -- ",shQuote(paste0(env1$path$path1,"/",env1$path$LastSourceEditorContext.path_filename.nb.html)) ) |> deparse() |> cat(" |> system(intern=TRUE)  \n", sep="")
```
  
  
