

function.shapefile.fortify.join = function(shapefile) {
    library(tidyverse)
    # shapefile.fortify = shapefile %>% fortify
    shapefile %>% fortify %>% left_join(shapefile@data %>% select(-long, -lat, -order, -hole, -piece, -group))
}


korpopmap1.CP949.fortify.join = korpopmap1.CP949 %>% function.shapefile.fortify.join
korpopmap2.CP949.fortify.join = korpopmap2.CP949 %>% function.shapefile.fortify.join
korpopmap3.CP949.fortify.join = korpopmap3.CP949 %>% function.shapefile.fortify.join
# > korpopmap2.CP949.fortify.join = korpopmap2.CP949 %>% function.shapefile.fortify.join
# Regions defined for each Polygons
# Joining, by = "id"
# > korpopmap3.CP949.fortify.join = korpopmap3.CP949 %>% function.shapefile.fortify.join
# Regions defined for each Polygons
# Joining, by = "id"


korpopmap1.CP949.fortify.join %>% str #----
korpopmap2.CP949.fortify.join %>% str #----
korpopmap3.CP949.fortify.join %>% str #----
# > korpopmap1.CP949.fortify.join %>% str #----
# 'data.frame':	6928 obs. of  42 variables:
#  $ long                   : num  127 127 127 127 127 ...
#  $ lat                    : num  37.7 37.7 37.7 37.7 37.7 ...
#  $ order                  : int  1 2 3 4 5 6 7 8 9 10 ...
#  $ hole                   : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ piece                  : Factor w/ 102 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ id                     : chr  "15" "15" "15" "15" ...
#  $ group                  : Factor w/ 186 levels "15.1","14.1",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ SP_ID                  : chr  "15" "15" "15" "15" ...
#  $ FID                    : chr  "15" "15" "15" "15" ...
#  $ code                   : chr  "11" "11" "11" "11" ...
#  $ code1                  : chr  "11" "11" "11" "11" ...
#  $ FID.data               : chr  "15" "15" "15" "15" ...
#  $ code.data              : chr  "11" "11" "11" "11" ...
#  $ code.1                 : chr  "11" "11" "11" "11" ...
#  $ name                   : chr  "서울특별시" "서울특별시" "서울특별시" "서울특별시" ...
#  $ name_eng               : chr  "Seoul" "Seoul" "Seoul" "Seoul" ...
#  $ base_year              : chr  "2010" "2010" "2010" "2010" ...
#  $ C행정구역별_읍면동     : chr  "11" "11" "11" "11" ...
#  $ 행정구역별_읍면동      : chr  "서울특별시" "서울특별시" "서울특별시" "서울특별시" ...
#  $ 시점                   : chr  "2010" "2010" "2010" "2010" ...
#  $ 총인구_명              : chr  "9794304" "9794304" "9794304" "9794304" ...
#  $ 남자_명                : chr  "4803373" "4803373" "4803373" "4803373" ...
#  $ 여자_명                : chr  "4990931" "4990931" "4990931" "4990931" ...
#  $ 내국인_계_명           : chr  "9631482" "9631482" "9631482" "9631482" ...
#  $ 내국인_남자_명         : chr  "4726028" "4726028" "4726028" "4726028" ...
#  $ 내국인_여자_명         : chr  "4905454" "4905454" "4905454" "4905454" ...
#  $ 외국인_계_명           : chr  "162822" "162822" "162822" "162822" ...
#  $ 외국인_남자_명         : chr  "77345" "77345" "77345" "77345" ...
#  $ 외국인_여자_명         : chr  "85477" "85477" "85477" "85477" ...
#  $ 가구_계_가구           : chr  "3577497" "3577497" "3577497" "3577497" ...
#  $ 일반가구_가구          : chr  "3504297" "3504297" "3504297" "3504297" ...
#  $ 집단가구_가구          : chr  "2836" "2836" "2836" "2836" ...
#  $ 외국인가구_가구        : chr  "70364" "70364" "70364" "70364" ...
#  $ 주택_계_호             : chr  "2525210" "2525210" "2525210" "2525210" ...
#  $ 단독주택_호            : chr  "405575" "405575" "405575" "405575" ...
#  $ 아파트_호              : chr  "1485869" "1485869" "1485869" "1485869" ...
#  $ 연립주택_호            : chr  "145914" "145914" "145914" "145914" ...
#  $ 다세대주택_호          : chr  "463417" "463417" "463417" "463417" ...
#  $ 비거주용_건물내_주택_호: chr  "24435" "24435" "24435" "24435" ...
#  $ 주택이외의_거처_호     : chr  "97389" "97389" "97389" "97389" ...
#  $ region                 : chr  "11" "11" "11" "11" ...
#  $ code1.data             : chr  "11" "11" "11" "11" ...
# > korpopmap2.CP949.fortify.join %>% str #----
# 'data.frame':	16926 obs. of  42 variables:
#  $ long                   : num  127 127 127 127 127 ...
#  $ lat                    : num  37.6 37.6 37.6 37.6 37.6 ...
#  $ order                  : int  1 2 3 4 5 6 7 8 9 10 ...
#  $ hole                   : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ piece                  : Factor w/ 37 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ id                     : chr  "250" "250" "250" "250" ...
#  $ group                  : Factor w/ 401 levels "250.1","249.1",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ SP_ID                  : chr  "250" "250" "250" "250" ...
#  $ FID                    : chr  "250" "250" "250" "250" ...
#  $ code                   : chr  "11010" "11010" "11010" "11010" ...
#  $ code1                  : chr  "11010" "11010" "11010" "11010" ...
#  $ FID.data               : chr  "250" "250" "250" "250" ...
#  $ code.data              : chr  "11010" "11010" "11010" "11010" ...
#  $ code.1                 : chr  "11010" "11010" "11010" "11010" ...
#  $ name                   : chr  "종로구" "종로구" "종로구" "종로구" ...
#  $ name_eng               : chr  "Jongno-gu" "Jongno-gu" "Jongno-gu" "Jongno-gu" ...
#  $ base_year              : chr  "2010" "2010" "2010" "2010" ...
#  $ C행정구역별_읍면동     : chr  "11010" "11010" "11010" "11010" ...
#  $ 행정구역별_읍면동      : chr  " 종로구" " 종로구" " 종로구" " 종로구" ...
#  $ 시점                   : chr  "2010" "2010" "2010" "2010" ...
#  $ 총인구_명              : chr  "155575" "155575" "155575" "155575" ...
#  $ 남자_명                : chr  "76408" "76408" "76408" "76408" ...
#  $ 여자_명                : chr  "79167" "79167" "79167" "79167" ...
#  $ 내국인_계_명           : chr  "151069" "151069" "151069" "151069" ...
#  $ 내국인_남자_명         : chr  "74331" "74331" "74331" "74331" ...
#  $ 내국인_여자_명         : chr  "76738" "76738" "76738" "76738" ...
#  $ 외국인_계_명           : chr  "4506" "4506" "4506" "4506" ...
#  $ 외국인_남자_명         : chr  "2077" "2077" "2077" "2077" ...
#  $ 외국인_여자_명         : chr  "2429" "2429" "2429" "2429" ...
#  $ 가구_계_가구           : chr  "60008" "60008" "60008" "60008" ...
#  $ 일반가구_가구          : chr  "57807" "57807" "57807" "57807" ...
#  $ 집단가구_가구          : chr  "152" "152" "152" "152" ...
#  $ 외국인가구_가구        : chr  "2049" "2049" "2049" "2049" ...
#  $ 주택_계_호             : chr  "41350" "41350" "41350" "41350" ...
#  $ 단독주택_호            : chr  "14429" "14429" "14429" "14429" ...
#  $ 아파트_호              : chr  "11067" "11067" "11067" "11067" ...
#  $ 연립주택_호            : chr  "5504" "5504" "5504" "5504" ...
#  $ 다세대주택_호          : chr  "9621" "9621" "9621" "9621" ...
#  $ 비거주용_건물내_주택_호: chr  "729" "729" "729" "729" ...
#  $ 주택이외의_거처_호     : chr  "2998" "2998" "2998" "2998" ...
#  $ region                 : chr  "11010" "11010" "11010" "11010" ...
#  $ code1.data             : chr  "11010" "11010" "11010" "11010" ...
# > korpopmap3.CP949.fortify.join %>% str #----
# 'data.frame':	70711 obs. of  42 variables:
#  $ long                   : num  127 127 127 127 127 ...
#  $ lat                    : num  37.6 37.6 37.6 37.6 37.6 ...
#  $ order                  : int  1 2 3 4 5 6 7 8 9 1 ...
#  $ hole                   : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ piece                  : Factor w/ 11 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
#  $ id                     : chr  "3471" "3471" "3471" "3471" ...
#  $ group                  : Factor w/ 3593 levels "3471.1","3470.1",..: 1 1 1 1 1 1 1 1 1 2 ...
#  $ SP_ID                  : chr  "3471" "3471" "3471" "3471" ...
#  $ FID                    : chr  "3471" "3471" "3471" "3471" ...
#  $ code                   : chr  "1101053" "1101053" "1101053" "1101053" ...
#  $ code1                  : chr  "1101053" "1101053" "1101053" "1101053" ...
#  $ FID.data               : chr  "3471" "3471" "3471" "3471" ...
#  $ code.data              : chr  "1101053" "1101053" "1101053" "1101053" ...
#  $ code.1                 : chr  "1101053" "1101053" "1101053" "1101053" ...
#  $ name                   : chr  "사직동" "사직동" "사직동" "사직동" ...
#  $ name_eng               : chr  "Sajik-dong" "Sajik-dong" "Sajik-dong" "Sajik-dong" ...
#  $ base_year              : chr  "2010" "2010" "2010" "2010" ...
#  $ C행정구역별_읍면동     : chr  "1101053" "1101053" "1101053" "1101053" ...
#  $ 행정구역별_읍면동      : chr  "  사직동" "  사직동" "  사직동" "  사직동" ...
#  $ 시점                   : chr  "2010" "2010" "2010" "2010" ...
#  $ 총인구_명              : chr  "8961" "8961" "8961" "8961" ...
#  $ 남자_명                : chr  "4182" "4182" "4182" "4182" ...
#  $ 여자_명                : chr  "4779" "4779" "4779" "4779" ...
#  $ 내국인_계_명           : chr  "8695" "8695" "8695" "8695" ...
#  $ 내국인_남자_명         : chr  "4051" "4051" "4051" "4051" ...
#  $ 내국인_여자_명         : chr  "4644" "4644" "4644" "4644" ...
#  $ 외국인_계_명           : chr  "266" "266" "266" "266" ...
#  $ 외국인_남자_명         : chr  "131" "131" "131" "131" ...
#  $ 외국인_여자_명         : chr  "135" "135" "135" "135" ...
#  $ 가구_계_가구           : chr  "3536" "3536" "3536" "3536" ...
#  $ 일반가구_가구          : chr  "3442" "3442" "3442" "3442" ...
#  $ 집단가구_가구          : chr  "6" "6" "6" "6" ...
#  $ 외국인가구_가구        : chr  "88" "88" "88" "88" ...
#  $ 주택_계_호             : chr  "2784" "2784" "2784" "2784" ...
#  $ 단독주택_호            : chr  "782" "782" "782" "782" ...
#  $ 아파트_호              : chr  "1493" "1493" "1493" "1493" ...
#  $ 연립주택_호            : chr  "65" "65" "65" "65" ...
#  $ 다세대주택_호          : chr  "412" "412" "412" "412" ...
#  $ 비거주용_건물내_주택_호: chr  "32" "32" "32" "32" ...
#  $ 주택이외의_거처_호     : chr  "574" "574" "574" "574" ...
#  $ region                 : chr  "1101053" "1101053" "1101053" "1101053" ...
#  $ code1.data             : chr  "1101053" "1101053" "1101053" "1101053" ...




korpopmap1.CP949.fortify.join %>% ggplot(aes(x=long, y=lat, group=group)) + geom_polygon(color='black', aes(fill = code))

korpopmap2.CP949.fortify.join %>% ggplot(aes(x=long, y=lat, group=group)) + geom_polygon(fill='white', color='black')
korpopmap2.CP949.fortify.join %>% mutate(code2 = code %>% substr(1, 2)) %>% 
    ggplot(aes(x=long, y=lat, group=group)) + geom_polygon(aes(fill = code2), color='black')

korpopmap3.CP949.fortify.join %>% mutate(code2 = code %>% substr(1, 2), code5 = code %>% substr(1, 5)) %>% 
    filter(code2 == "11") %>% 
    ggplot(aes(x=long, y=lat, group=group)) + geom_polygon(aes(fill = code5), color='black')


