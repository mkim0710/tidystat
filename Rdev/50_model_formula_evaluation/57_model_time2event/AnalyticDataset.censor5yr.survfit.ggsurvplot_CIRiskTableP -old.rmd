---
title: "MHKim's R Notebook"
output: html_notebook
    df_print: tibble
---

# _______________
```{r Rstudio-RMarkDown-Shortcuts, eval=FALSE, include=FALSE} 
##### Rstudio RMarkDown Shortcuts
https://support.posit.co/hc/en-us/articles/200711853-Keyboard-Shortcuts-in-the-RStudio-IDE  
https://bookdown.org/yihui/rmarkdown-cookbook/rstudio-shortcuts.html  
Insert R chunk	Ctrl+Alt+I	Command+Option+I\
Preview HTML	Ctrl+Shift+K	Command+Shift+K\
Run all chunks above	Ctrl+Alt+P	Command+Option+P\
Run current chunk	Ctrl+Alt+C	Command+Option+C\
Run current chunk	Ctrl+Shift+Enter	Command+Shift+Enter\
Run next chunk	Ctrl+Alt+N	Command+Option+N\
Run all chunks	Ctrl+Alt+R	Command+Option+R\
Go to next chunk/title	Ctrl+PgDown	Command+PgDown\
Go to previous chunk/title	Ctrl+PgUp	Command+PgUp\
Show/hide document outline	Ctrl+Shift+O	Command+Shift+O\
F7 spell-check your document.\
Restart the R session   Ctrl + Alt + F10 (or Command + Option + F10 on macOS).\
\
*** Caution: \% \$ \# \* \
*** Caution: RMarkdown does not support the use of the pipe operator (%>%). Use the pipe operator in the code chunk instead.\
```

```{r setup, eval=TRUE, include=FALSE}
# str(knitr::opts_chunk$get())
# cat(deparse(knitr::opts_chunk$get(), width.cutoff=120), "\n", sep="")
# list(eval=TRUE, echo=TRUE, results = "markup", tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = "##",     highlight = TRUE, size = "normalsize", background = "#F7F7F7", strip.white = structure(TRUE, class = "AsIs"), cache = FALSE,     cache.path = "cache/", cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, autodep = FALSE, cache.rebuild = FALSE,     fig.keep = "high", fig.show = "asis", fig.align = "default", fig.path = "figure/", dev = NULL, dev.args = NULL, dpi = 72,     fig.ext = NULL, fig.width=7, fig.height=7, fig.env = "figure", fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:",     fig.subcap = NULL, fig.pos = "", out.width=NULL, out.height=NULL, out.extra = NULL, fig.retina = 1, external = TRUE,     sanitize = FALSE, interval = 1, aniopts = "controls,loop", warning = TRUE, error = TRUE, message = TRUE, render = NULL,     ref.label = NULL, child = NULL, engine = "R", split = FALSE, include = TRUE, purl = TRUE)
knitr::opts_chunk$set(
  eval=TRUE, echo=TRUE, results="markup", collapse=TRUE, # In Rstudio Notebook Source Pane & nb.HTML, results="hold" does not work
  comment="", fig.width=10, fig.height=6, # In Rstudio Notebook Source Pane & nb.HTML, comment="##" does not work?
  warning=TRUE, error=TRUE, message=TRUE, include=TRUE, 
  tidy.opts=list(width.cutoff=120), tidy=TRUE, 
  R.options = list(width=120), paged.print=FALSE
) 
knitr::opts_knit$set(global.par = TRUE)
```


```{r options-width-NoEchoHideResults, echo=FALSE, results="hide"}
if(!exists("env.custom", envir=.GlobalEnv)) assign("env.custom", new.env(), envir=.GlobalEnv)
if(!"info" %in% names(env.custom)) env.custom$info = list()
env.custom$info$options.width = options()$width; cat(options()$width, "\n", sep="")
```


```{r loadPackages-NoEchoHideResults, echo=FALSE, results="hide"}
suppressPackageStartupMessages({for(packagename in c("tidyverse","formatR")){if(!require(packagename,character.only=TRUE))install.packages(packagename) else library(packagename,character.only=TRUE)}});cat("\n");
if(!exists("env.custom", envir=.GlobalEnv)) assign("env.custom", new.env(), envir=.GlobalEnv)
if(!"path" %in% names(env.custom)) {
    env.custom$path = list()
    objectname = "source_base_local"; object = "D:/OneDrive/[][Rproject]/github_tidystat"; if(!objectname %in% names(env.custom$path)) {env.custom$path[[objectname]] = object};
    objectname = "source_base_github"; object = "https://github.com/mkim0710/tidystat/raw/master"; if(!objectname %in% names(env.custom$path)) {env.custom$path[[objectname]] = object};
    env.custom$path$source_base = ifelse(dir.exists(env.custom$path$source_base_local), env.custom$path$source_base_local, env.custom$path$source_base_github)  
} 
sourcename = "env.custom$env.internal"; suppressPackageStartupMessages(source( file.path(file.path(env.custom$path$source_base,""), paste0(sourcename,".source.r")) ))
sourcename = "f_df.t.tribble_construct"; suppressPackageStartupMessages(source( file.path(file.path(env.custom$path$source_base,""), paste0(sourcename,".source.r")) ))
```



<font size="3">\% env.custom</font>\
<font size="3">\% env.custom\$info</font>\

#### \% env.custom\$info\$info_system_info
```{r envCustom-Info-NoEchoHideResults, echo=FALSE, results="hide"}
# https://yihui.org/knitr/options/#package-options
if(!exists("env.custom", envir=.GlobalEnv)) assign("env.custom", new.env(), envir=.GlobalEnv)
if(!"info" %in% names(env.custom)) env.custom$info = list()
sourcename = "get_system_info"; suppressPackageStartupMessages(source( file.path(file.path(env.custom$path$source_base,""), paste0(sourcename,".source.r")) ))
env.custom$info$info_system_info = env.custom$info$get_system_info()
# str(env.custom$info$info_system_info)
CodeText = "env.custom$info$info_system_info$machine_nodename"; cat(CodeText, ' = "', eval(parse(text=CodeText)), '"', "\n", sep="")
CodeText = "env.custom$info$info_system_info$Sys.getlocale$LC_COLLATE"; cat(CodeText, ' = "', eval(parse(text=CodeText)), '"', "\n", sep="")
# CodeText = "env.custom$info$info_system_info$l10n_info$localization_UTF8"; cat(CodeText, ' = "', eval(parse(text=CodeText)), '"', "\n", sep="")
env.custom$info$info_software_versions = env.custom$info$get_software_versions(library_names = c("tidyverse", "dplyr", "ggplot2", "purrr", "stringr", "datapasta","openxlsx"))
# str(env.custom$info$info_software_versions)
```


#### \% env.custom\$info\$DocumentTitle1
```{r envCustom-DocumentTitle1-NoEchoHideResults, echo=FALSE, results="hide"}
env.custom$info$DocumentTitle0 = paste0("00env.custom", "-", basename(getwd()))
env.custom$info$DocumentTitle1 = paste0(env.custom$info$DocumentTitle0,"@", ifelse(grepl("MacBook-Pro", Sys.info()["nodename"]), "MBP", Sys.info()["nodename"]))
cat(env.custom$info$DocumentTitle0,"-",format(Sys.time(),"%y%m%d"), "\n", 
    env.custom$info$DocumentTitle0,"-",format(Sys.time(),"%y%m%d"),".r", "\n", 
    env.custom$info$DocumentTitle0,"-dev",format(Sys.time(),"%y%m%d"),".r", "\n", 
    env.custom$info$DocumentTitle0,"-clean",format(Sys.time(),"%y%m%d"),".r", "\n", 
    env.custom$info$DocumentTitle0,"-",format(Sys.time(),"%y%m%d"),".Rmd", "\n", 
    env.custom$info$DocumentTitle0,"-dev",format(Sys.time(),"%y%m%d"),".Rmd", "\n", 
    env.custom$info$DocumentTitle0,"-clean",format(Sys.time(),"%y%m%d"),".Rmd", "\n", 
    sep="")
```


@ASROCKX300RYZEN
List of 9
 $ GUI             : chr "RStudio"
 $ os_type         : chr "windows"
 $ os_sysname      : chr "Windows"
 $ os_version      : chr "build 22621"
 $ machine_type    : chr "x86-64"
 $ machine_nodename: chr "ASROCKX300RYZEN"
 $ machine_cpu     : chr "AMD Ryzen 5 5600G with Radeon Graphics"
 $ Sys.getlocale   :List of 4
  ..$ LC_COLLATE       : chr "Korean_Korea.utf8"
  ..$ LC_CTYPE         : chr "Korean_Korea.utf8"
  ..$ LC_locale_NUMERIC: chr "C"
  ..$ LC_locale_TIME   : chr "Korean_Korea.utf8"
 $ l10n_info       :List of 5
  ..$ localization_UTF8           : logi TRUE
  ..$ localization_Latin1         : logi FALSE
  ..$ localization_codeset        : NULL
  ..$ localization_codepage       : int 65001
  ..$ localization_system.codepage: int 65001
  
  
@LIVAI7-8700
List of 9
 $ GUI             : chr "RStudio"
 $ os_type         : chr "windows"
 $ os_sysname      : chr "Windows"
 $ os_version      : chr "build 19045"
 $ machine_type    : chr "x86-64"
 $ machine_nodename: chr "LIVAI7-8700"
 $ machine_cpu     : chr "Intel(R) Core(TM) i7-8700 CPU @ 3.20GHz"
 $ Sys.getlocale   :List of 4
  ..$ LC_COLLATE       : chr "Korean_Korea.utf8"
  ..$ LC_CTYPE         : chr "Korean_Korea.utf8"
  ..$ LC_locale_NUMERIC: chr "C"
  ..$ LC_locale_TIME   : chr "Korean_Korea.utf8"
 $ l10n_info       :List of 5
  ..$ localization_UTF8           : logi TRUE
  ..$ localization_Latin1         : logi FALSE
  ..$ localization_codeset        : NULL
  ..$ localization_codepage       : int 65001
  ..$ localization_system.codepage: int 65001


@Posit Cloud
List of 9
 $ GUI             : chr "RStudio"
 $ os_type         : chr "unix"
 $ os_sysname      : chr "Linux"
 $ os_version      : chr "#96~18.04.1-Ubuntu SMP Mon Oct 17 02:57:48 UTC 2022"
 $ machine_type    : chr "x86_64"
 $ machine_nodename: chr "application-9677950-deployment-19172365-82455"
 $ machine_cpu     : chr "AMD EPYC 7R13 Processor"
 $ Sys.getlocale   :List of 4
  ..$ LC_COLLATE       : chr "C.UTF-8"
  ..$ LC_CTYPE         : chr "C.UTF-8"
  ..$ LC_locale_NUMERIC: chr "C"
  ..$ LC_locale_TIME   : chr "C.UTF-8"
 $ l10n_info       :List of 5
  ..$ localization_UTF8           : logi TRUE
  ..$ localization_Latin1         : logi FALSE
  ..$ localization_codeset        : chr "UTF-8"
  ..$ localization_codepage       : NULL
  ..$ localization_system.codepage: NULL
  



################################################
#### \% env.custom\$path    
<font size="2">\% env.custom\$path\$data_suffix</font>\
<font size="2">\% env.custom\$path\$project_suffix</font>\
```{r envCustom-Path-NoEcho, echo=FALSE, results="markup", collapse=TRUE, paged.print=FALSE}
library(tidyverse);cat("\n"); 
cat("\n"); cat("getwd() == "); dput(getwd()) #----
env.custom$path$getwd = getwd()
# env.custom$path$path0 = file.path("D:", "OneDrive - SNU", "[][Rproject]")
# env.custom$path$project_base = "Rproject_HEALS0215"
# env.custom$path$data_suffix = "_01"
# # env.custom$path$data_suffix = ""
# env.custom$path$project_suffix = "GJ3"
# 
# 
# env.custom$path$path4read = file.path(env.custom$path$path0, paste0(env.custom$path$project_base, env.custom$path$data_suffix))
# env.custom$path$path4write = file.path(env.custom$path$path4read, paste0(env.custom$path$project_base, env.custom$path$data_suffix, env.custom$path$project_suffix))
cat("> str(env.custom$path)\n"); str(env.custom$path, max.level = 1, give.attr = F)  
# 
# path4read  = env.custom$path$path4read
# # path4write = env.custom$path$path4read
# # path4write = env.custom$path$path4write
path4read = getwd()
path4write = getwd()
sourcename = "f_objectname.read.checkEntity"; suppressPackageStartupMessages(source( file.path(file.path(env.custom$path$source_base,""), paste0(sourcename,".source.r")) ))
if (getwd() != path4write) warning("getwd() != path4write  == ") else cat("getwd() == path4write == "); dput(path4write)  #----
```


##% env.custom$f_path.size_files() ====
```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
# tribble_paste = datapasta::tribble_paste
# https://github.com/mkim0710/tidystat/blob/master/f_df.t.tribble_construct.dev.r
load(url("https://github.com/mkim0710/tidystat/raw/master/f_df.t.tribble_construct.RData"))
# attach(env.custom)

# regex4filename = "\\.rds(\\.xz)?$"
regex4filename = "\\.rds\\.xz$"
list.files(path4write) %>% grep(regex4filename, ., value = T) %>% {cat("----\n", deparse(., width.cutoff=120), "\n\n", sep="")} # dput() cat(deparse(., width.cutoff=120)), width.cutoff=500 is the max ----
env.custom$f_path.size_files(path4read = path4write, regex4filename = regex4filename)

cat(strrep("-",80),"\n",sep=""); #----
regex4filename = "\\.rds$"
list.files(path4write) %>% grep(regex4filename, ., value = T) %>% {cat("----\n", deparse(., width.cutoff=120), "\n\n", sep="")} # dput() cat(deparse(., width.cutoff=120)), width.cutoff=500 is the max ----
env.custom$f_path.size_files(path4read = path4write, regex4filename = regex4filename)
```



# @@ START ------

# \$ objectname = "tblID_gj3_jk" ====
@ assign(objectname, read_rds(file.path(path4read, paste0(objectname,".rds")))) 
```{r objectname-read.checkEntity, echo=TRUE, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
# sourcename = "f_objectname.read.checkEntity"; suppressPackageStartupMessages(source( file.path(file.path(env.custom$path$source_base,""), paste0(sourcename,".source.r")) ))
# objectname = "tblID_gj3_jk"; cat("----\n> ", 'objectname = "', objectname, '"\n', sep=""); 
# filename2read = if(file.exists(file.path(path4read, paste0(objectname,".rds")))) paste0(objectname,".rds") else paste0(objectname, ".rds.xz")
# env.custom$f_path.size_files(path4read = path4read, regex4filename = filename2read)
# system.time(assign(objectname, readRDS(file.path(path4read, filename2read)), envir=.GlobalEnv))
# cat("dim(",objectname,") = ",deparse(dim(get(objectname))),"\n", sep="")

# get(objectname) %>% {.$PERSON_ID} %>% n_distinct
# get(objectname) %>% {.$RN_INDI} %>% n_distinct
# get(objectname) %>% names %>% {cat("----\n", deparse(., width.cutoff=120), "\n\n", sep="")} # dput() cat(deparse(., width.cutoff=120)), width.cutoff=500 is the max ----
# get(objectname) %>% names %>% paste(collapse=", ") %>% {cat("----\n", ., "\n\n", sep="")}; # tidyselect: paste(collapse=", ") %>% cat ----
# cat("----\n> ", "str(get(objectname), max.level = 2, give.attr = F)", "\n", sep=""); str(get(objectname), max.level = 2, give.attr = F); 
# # get(objectname) %>% select_if(is.numeric) %>% summary #-----
# # get(objectname) %>% select_if(is.logical) %>% summary #-----
```



# \$ lung <- as_tibble(survival::lung) ======
## Step 1: Load the Required Libraries and Data
## Step 2: Exploratory Data Analysis
```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
library(tidyverse)
library(survival)
library(survminer)

# # Load the lung dataset
# # data("lung")
# lung <- as_tibble(survival::lung)
# lung
as_tibble(survival::lung)
summary(survival::lung)
```



## Step 3: Kaplan-Meier Survival Curve
```{r, paged.print=FALSE, fig.width=8, fig.height=6}
library(tidyverse)
# library(survival)
# library(survminer)
survminer::ggsurvplot(survival::survfit(survival::Surv(time = time, event = status) ~ 1, data = survival::lung)
           , break.time.by = 365
           , conf.int = TRUE, risk.table = TRUE, pval = TRUE
           , title = "Kaplan-Meier Survival Curve"
           , xlab = "Time in days", ylab = "Survival Probability")

```

## Step 4: Stratified Kaplan-Meier Survival Curve
```{r, paged.print=FALSE, fig.width=8, fig.height=6}
library(tidyverse)
# library(survival)
# library(survminer)
survminer::ggsurvplot(survival::survfit(survival::Surv(time = time, event = status) ~ sex, data = survival::lung), palette = c("#00AFBB", "#FC4E07")
           , break.time.by = 365
           , conf.int = TRUE, risk.table = TRUE, pval = TRUE
           , title = "Survival Curves Stratified by Sex"
           , xlab = "Time in days", ylab = "Survival Probability")

```

## Step 5: Cox Proportional Hazards Model
```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
# Fit a Cox proportional hazards model
cox_model <- coxph(surv_obj ~ sex + age + ph.ecog, data = survival::lung)

# Summary of the Cox model
summary(cox_model)

```

## Step 6: Check Proportional Hazards Assumption
```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
# Test for proportional hazards
cox.zph(cox_model)
```

# https://github.com/mkim0710/tidystat/blob/master/Rdev/50_model_formula_evaluation/57_model_time2event/AnalyticDataset.censor1yr.survfit.ggsurvplot_CIRiskTableP.dev.r

## \$ AnalyticDataset ====
```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
AnalyticDataset = lung %>% rename(event = status, Group = sex)
AnalyticDataset.survfit <- survfit(Surv(time = time, event = event) ~ Group, data = AnalyticDataset)

?survminer::ggsurvplot  # "event" plots cumulative events (f(y) = 1-y), "cumhaz" plots the cumulative hazard function (f(y) = -log(y)), and "pct" for survival probability in percentage.

# AnalyticDataset.survfit %>% ggsurvplot(fun = "pct")  # default fun = "pct"?
# AnalyticDataset.survfit %>% ggsurvplot(fun = "event")
# AnalyticDataset.survfit %>% ggsurvplot(fun = "cumhaz")  # Cumulative Hazard = -log S(t)

AnalyticDataset.survfit %>% ggsurvplot  # default fun = "pct"?
```


```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
AnalyticDataset.survfit %>% ggsurvplot(conf.int = T, risk.table = T, pval = T)
```



```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
AnalyticDataset.coxph <- coxph(Surv(time = time, event = event) ~ Group, data = AnalyticDataset)
AnalyticDataset.coxph %>% summary #----
AnalyticDataset.coxph %>% cox.zph # * Caution) significant = bad news, large p = good news~! Having very small p values indicates that there are time dependent coefficients which you need to take care of ----
AnalyticDataset.coxph %>% cox.zph %>% ggcoxzph #----
```



## \$ AnalyticDataset.censor1yr ====
```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)

value_for_censor_at_1yr = 365 * 1
value_for_break.time.by = 30
AnalyticDataset.censor1yr = AnalyticDataset %>% mutate(
    time.censor1yr = pmin(time, value_for_censor_at_1yr)
    , event.censor1yr = ifelse(time < value_for_censor_at_1yr, event, 0)
)
AnalyticDataset.censor1yr.survfit = survfit(Surv(time = time.censor1yr, event = event.censor1yr) ~ Group, data = AnalyticDataset.censor1yr)

# AnalyticDataset.censor1yr.survfit %>% ggsurvplot(fun = "pct")  # default fun = "pct"?
# AnalyticDataset.censor1yr.survfit %>% ggsurvplot(fun = "event")
# AnalyticDataset.censor1yr.survfit %>% ggsurvplot(fun = "cumhaz")  # Cumulative Hazard = -log S(t)

AnalyticDataset.censor1yr.survfit %>% ggsurvplot  # default fun = "pct"?

```


```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
AnalyticDataset.censor1yr.survfit %>% ggsurvplot(conf.int = T, risk.table = T, pval = T, break.time.by = value_for_break.time.by)

```


```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)
AnalyticDataset.censor1yr.survfit %>% ggsurvplot(conf.int = T, risk.table = T, pval = T, break.time.by = value_for_break.time.by)

```


```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)

```


```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)

```


```{r, results="markup", collapse=TRUE, paged.print=FALSE, comment="", R.options=list(width=120)}
options(width=120)

```


# @@ START) Analysis ------

# \$ objectname = "analyticDF_time2event" ====
# [Plot] Stratified Kaplan-Meier Survival Curve
```{r plot-CodeTemplate, eval=FALSE, include=FALSE}
# {r plotWidth10Height6, results="markup", collapse=TRUE, paged.print=FALSE, fig.width=10, fig.height=6}
options(width=120)
suppressPackageStartupMessages(library(tidyverse))
# suppressPackageStartupMessages(library(survival))
# suppressPackageStartupMessages(library(survminer))
?survival::lung 
AnalyticDataset = survival::lung %>% mutate(event = as.logical(status-1), Group = c("Male", "Female")[sex] %>% as.factor)
# AnalyticDataset %>% select(sex, Group) %>% {cat("> ",deparse(substitute(.))," %>% str","\n", sep=""); str(.)}
# AnalyticDataset %>% select(sex, Group) %>% table
# # > AnalyticDataset %>% select(sex, Group) %>% {cat("> ",deparse(substitute(.))," %>% str","\n", sep=""); str(.)}
# # 'data.frame':	228 obs. of  2 variables:
# #  $ sex  : num  1 1 1 1 1 1 2 2 1 1 ...
# #  $ Group: Factor w/ 2 levels "Female","Male": 2 2 2 2 2 2 1 1 2 2 ...
# # > AnalyticDataset %>% select(sex, Group) %>% table
# #    Group
# # sex Female Male
# #   1      0  138
# #   2     90    0
AnalyticDataset %>% select(time, event, Group) %>% summary

?survminer::ggsurvplot  # "event" plots cumulative events (f(y) = 1-y), "cumhaz" plots the cumulative hazard function (f(y) = -log(y)), and "pct" for survival probability in percentage.
# AnalyticDataset.survfit %>% ggsurvplot(fun = "pct")  # default fun = "pct"?
# AnalyticDataset.survfit %>% ggsurvplot(fun = "event")
# AnalyticDataset.survfit %>% ggsurvplot(fun = "cumhaz")  # Cumulative Hazard = -log S(t)
value_for_censor_at_1yr = 365 * 1
value_for_break.time.by = 30
time_scale = "days"
varname4Group = "Group"
AnalyticDataset.censor1yr = AnalyticDataset %>% mutate(
    # time.censor1yr = pmin(time, value_for_censor_at_1yr)
    # , event.censor1yr = ifelse(time < value_for_censor_at_1yr, event, 0)
    time = pmin(time, value_for_censor_at_1yr)
    , event = ifelse(time < value_for_censor_at_1yr, event, F)
)
survminer::ggsurvplot(survival::survfit(survival::Surv(time = time, event = event) ~ Group, data = AnalyticDataset.censor1yr), palette = c("#00AFBB", "#FC4E07")
           , break.time.by = value_for_break.time.by
           , conf.int = TRUE, risk.table = TRUE, pval = TRUE
           , title = paste0("Survival Curves Stratified by ", varname4Group)
           , xlab = paste0("Time in ", time_scale), ylab = "Survival Probability")

```

# @@ END -----
```{r END-NoEvalNoEchoNoMsgNoResults, eval=FALSE, echo=FALSE, warning=TRUE, error=TRUE, message=FALSE, results="hide", collapse=TRUE, paged.print=FALSE}
# @@ END -----

```


```{comment RenderMessages, eval=FALSE, include=FALSE}
dput(names(knitr::knit_engines$get()))
```


# \$ objectname = "AnalyticDataset200621" ====
###### @ write_rds( get(objectname), file.path(path4write, paste0(objectname,".rds"))) -----
```{r writeRDS-NoEvalNoEchoNoMsgNoResults, eval=FALSE, echo=FALSE, warning=TRUE, error=TRUE, message=FALSE, results="hide", collapse=TRUE, paged.print=FALSE}
# 
# @ write_rds( get(objectname), file.path(path4write, paste0(objectname,".rds"))) -----
# objectname = "AnalyticDataset200621"
# system.time(write_rds( get(objectname),paste0(objectname,".rds")))
# # system.time(write_rds( get(objectname), file.path(path4write, paste0(objectname,".rds"))))
# # system.time(write_rds( get(objectname), file.path(path4write, paste0(objectname,".rds")), compress = "gz" ))
# # system.time(write_rds( get(objectname), file.path(path4write, paste0(objectname, ".rds", "")), compress = "xz", compression = 9 ))
# # system.time(openxlsx::write.xlsx(get(objectname), file=paste0(objectname,".xlsx"), asTable=TRUE, withFilter=TRUE))
# # openxlsx::openXL(paste0(objectname, ".xlsx"))
```


