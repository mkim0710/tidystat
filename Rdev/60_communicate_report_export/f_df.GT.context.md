analyze the following github repo:
https://github.com/ddsjoberg/gtsummary
analyze the functionality and the program logics - I want to eventually adopt some features in the repo into my custom functions for data table/report generation.

I like the features in the gtsummary library, but the library seems to often update without backward compatibility. Therefore, I want to reduce the dependency on the gtsummary library. 
I still want tidyverse, flextable, and officer, because I want the final output to be in both word & excel, which will be finally formatted as scientific journal manuscript. 

___
## I want to refactor the following code to reduce the dependency on the gtsummary library.
If dependency on the gtsummary remains, I need the function to be compatible with gtsummary version 2.2.0 or above. Note that the functions in gtsummary might not be backward compatible. 
I still want tidyverse, flextable, and officer, because I want the final output to be in both word & excel, which will be finally formatted as scientific journal manuscript.
I need to reduce the dependency on the env1 object (https://raw.githubusercontent.com/mkim0710/tidystat/refs/heads/master/env1%24env.internal.source.r) as well.

```r
byVar = "A01_BMI_ge250"
.Regex4proxies.byVar = byVar %>% str_extract("^[A-Za-z0-9]+_[A-Za-z0-9]+")
DS4uvregression = DS.DNR %>%
select(matches("^A0[0-1]"), all_of(byVar)) %>%
select(-matches(.Regex4proxies.byVar), all_of(byVar)) %>%
# mutate_if(is.factor, droplevels) %>%
# select_if(function(x) !is.factor(x) || is.factor(x) && length(levels(x)) = 2) %>%
select_if(function(x) !is.factor(x)) %>%
select_if(function(x) !all(is.na(x))) %>%
select_if(function(vec) !is.Date(vec))
env1$env.internal.attach$Sys.time.set_t0()
GT2_uvregression = DS4uvregression %>%
mutate_if(is.factor, droplevels) %>%
select_if(function(x) !all(is.na(x))) %>%
select_if(function(vec) !is.Date(vec)) %>%
select_if(function(vec) n_distinct(vec[!is.na(vec)]) > 1) %>%
tbl_uvregression(
method = glm,
method.arg = list(family = binomial),
y = !!rlang::sym(byVar),
exponentiate = TRUE
) %>%
add_global_p(keep = TRUE) %>%
# add_n(location = "both") %>%
# add_nevent(location = "both") |>
add_n(location = "level") %>%
add_nevent(location = "level") |>
# modify_header(all_stat_cols() ~ "**{level}**  nN = {n} ({style_percent(p)}%)", p.value ~ "***p***") |>
modify_header(p.value ~ "***p***") |>
# modify_spanning_header(all_stat_cols() ~ "summary") |>
bold_p(t = 0.10) |>
bold_labels() |>
italicize_levels() |>
env1$f$f_expression.eval.withCallingHandlers.attr_warnings.summary()
env1$env.internal.attach$Sys.time.from_t0()  # Time difference of 4.008291 mins → Time difference of 31.2056 secs @ select_if(function(x) !is.factor(x))

GT2_uvregression %>% show_header_names
GT2_uvregression$table_body %>% select(variable, N_obs, N_event, label, estimate, std.error, statistic, conf.low, conf.high, ci, p.value) |> print(n=99)
GT2_uvregression |>
print() |> invisible()
```

___
## I want to make a manuscript like the one generated from the code I shared (using tbl_uvregression).
See the following code, which were my previous code for manuscirpt table generation.

https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/f_df.summary_byExposure.dev.Rmd
https://github.com/mkim0710/tidystat/blob/master/Rdev/50_model_formula_evaluation/57_model_time2event/f_df.PersonTime.dev.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/function.HazardRatios.spread.dev.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/function.ggplot.ORCI.dev.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/function.tbl_varname_level_ORCI.source.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/function.tbl_varname_level_HRCI.dev.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/function.lm_object.summary.coefCI.dev.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/60_communicate_report_export/function.glm_object.summary.exp()%20-debug%20180806.r
https://github.com/mkim0710/tidystat/blob/master/Rdev/50_model_formula_evaluation/55_model_weighted/function.svyglm.MainModel.byEffectModifier.dev.r

Please explain how I may modify them to look like the code I shared (using tbl_uvregression).

## Clarifications Q & As

### Table Structure: 
Do your manuscript tables usually present all predictors together in a single panel (i.e., one large table), or do you prefer to group them by domain (e.g., demographics, clinical labs, etc.)? prefer to group them by domain 

### Three-variable Tables: 
For the GT2_3vregression scripts, are the three variables always fixed, or should the refactored function accept an arbitrary list of 1–3 predictors to include side-by-side? main exposure & age & sex

### Excel Export: 
Should Excel export preserve flextable formatting (e.g., via flextable::save_as_excel() or officer::print()) or is a raw data export sufficient (via writexl::write_xlsx() or similar)? I prefer flextable & officer because I need to write word & excel files.

### Statistical Models: 
Should the refactored logic automatically detect model family (e.g., logistic, linear, Cox) based on outcome, or do you prefer passing the method explicitly? need both automation & explicit assignment

### Data Context: 
What is the structure of DS.DNR? Is it a data frame with primarily numeric and factor columns? Are there specific data types or patterns I should be aware of?
See below:
```r
CohortGJ0910.BaselineJKGJ2085NoHx...01 <- readRDS("data/CohortGJ0910.BaselineJKGJ2085NoHx...01.rds")
DS.DNR = CohortGJ0910.BaselineJKGJ2085NoHx...01 %>%
    rownames_to_column()
DS.DNR |> str(max.level = 2, give.attr = TRUE)
# > DS.DNR |> str(max.level = 2, give.attr = TRUE)
# tibble [2,837 × 60] (S3: tbl_df/tbl/data.frame)
#  $ rowname                      : chr [1:2837] "1" "2" "3" "4" ...
#  $ PERSON_ID                    : chr [1:2837] "10162952" "10351260" "10363009" "10458592" ...
#  $ EnrollYear                   : Factor w/ 2 levels "2009","2010": 1 1 1 1 1 1 1 1 1 1 ...
#  $ SEX                          : Factor w/ 2 levels "Male","Female": 2 1 2 1 2 1 2 1 2 2 ...
#  $ AGE_GROUP                    : Factor w/ 19 levels "0","1","2","3",..: 16 12 12 10 7 9 14 7 12 7 ...
#  $ SIDO                         : Factor w/ 17 levels "11","26","27",..: 15 2 1 9 1 1 2 12 1 3 ...
#  $ SGG                          : Factor w/ 264 levels "11110","11140",..: 229 41 12 90 7 12 40 158 17 44 ...
#  $ IPSN_TYPE_CD                 : Factor w/ 6 levels "1","2","5","6",..: 4 1 3 1 3 3 3 3 2 3 ...
#  $ CTRB_PT_TYPE_CD              : Factor w/ 11 levels "0","1","2","3",..: 10 7 2 10 6 7 3 8 10 6 ...
#  $ DFAB_GRD_CD                  : Factor w/ 3 levels "0","1","2": 1 1 1 3 1 1 1 1 1 1 ...
#  $ DFAB_PTN_CD                  : Factor w/ 9 levels "0","1","2","3",..: 1 1 1 2 1 1 1 1 1 1 ...
#  $ YKIHO_GUBUN_CD               : Factor w/ 19 levels "10","20","28",..: 2 2 2 2 2 2 7 1 2 2 ...
#  $ HEIGHT                       : num [1:2837] 136 159 152 164 159 181 152 173 164 161 ...
#  $ WEIGHT                       : num [1:2837] 55 58 71 70 54 65 48 69 61 53 ...
#  $ BP_HIGH                      : num [1:2837] 120 120 117 140 133 109 139 115 140 110 ...
#  $ BP_LWST                      : num [1:2837] 70 80 86 80 82 69 76 70 85 70 ...
#  $ BLDS                         : num [1:2837] 117 104 95 84 98 90 100 87 90 86 ...
#  $ TOT_CHOLE                    : num [1:2837] 207 189 233 212 164 230 289 175 203 168 ...
#  $ SGOT_AST                     : num [1:2837] 29 15 25 56 17 17 24 29 40 14 ...
#  $ SGPT_ALT                     : num [1:2837] 20 16 34 119 10 9 24 67 32 14 ...
#  $ GAMMA_GTP                    : num [1:2837] 28 16 33 169 14 9 23 62 15 14 ...
#  $ WAIST                        : num [1:2837] 93 74 92 98 64 83 78 86 74 66 ...
#  $ TRIGLYCERIDE                 : num [1:2837] 170 100 241 499 42 90 106 109 153 65 ...
#  $ HDL_CHOLE                    : num [1:2837] 39 57 70 51 66 46 58 40 51 69 ...
#  $ LDL_CHOLE                    : num [1:2837] 134 112 115 61 89 166 209 127 121 86 ...
#  $ CREATININE                   : num [1:2837] 0.7 1.2 1 1 1 ...
#  $ HCHK_APOP_PMH_YN             : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
#  $ HCHK_HDISE_PMH_YN            : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
#  $ HCHK_HPRTS_PMH_YN            : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 2 1 1 1 ...
#  $ HCHK_DIABML_PMH_YN           : Factor w/ 2 levels "0","1": 2 1 1 1 1 1 1 1 1 1 ...
#  $ HCHK_HPLPDM_PMH_YN           : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 2 1 1 1 ...
#  $ HCHK_ETCDSE_PMH_YN           : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
#  $ HCHK_PHSS_PMH_YN             : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
#  $ Female                       : logi [1:2837] TRUE FALSE TRUE FALSE TRUE FALSE ...
#  $ BMI                          : num [1:2837] 29.7 22.9 30.7 26 21.4 ...
#  $ BMI_lt185                    : logi [1:2837] FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ BMI_ge185lt230               : logi [1:2837] FALSE TRUE FALSE FALSE TRUE TRUE ...
#  $ BMI_ge230lt250               : logi [1:2837] FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ BMI_ge185lt250               : logi [1:2837] FALSE TRUE FALSE FALSE TRUE TRUE ...
#  $ BMI_ge250lt300               : logi [1:2837] TRUE FALSE FALSE TRUE FALSE FALSE ...
#  $ BMI_ge300                    : logi [1:2837] FALSE FALSE TRUE FALSE FALSE FALSE ...
#  $ BMI_ge350                    : logi [1:2837] FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ BMI_ge400                    : logi [1:2837] FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ BMI.cut4                     : Factor w/ 4 levels "[0,18.5)","[18.5,25)",..: 3 2 4 3 2 2 2 2 2 2 ...
#  $ FPG                          : num [1:2837] 117 104 95 84 98 90 100 87 90 86 ...
#  $ FPG_ge100                    : logi [1:2837] TRUE TRUE FALSE FALSE FALSE FALSE ...
#  $ FPG_ge126                    : logi [1:2837] FALSE FALSE FALSE FALSE FALSE FALSE ...
#  $ SBP                          : num [1:2837] 120 120 117 140 133 109 139 115 140 110 ...
#  $ DBP                          : num [1:2837] 70 80 86 80 82 69 76 70 85 70 ...
#  $ BP_ESCESH2018                : Factor w/ 6 levels "(1) Optimal BP",..: 2 2 3 4 3 1 3 1 4 1 ...
#  $ FPG_ge100lt126               : logi [1:2837] TRUE TRUE FALSE FALSE FALSE FALSE ...
#  $ TRIGLYCERIDE_ge150           : logi [1:2837] TRUE FALSE TRUE TRUE FALSE FALSE ...
#  $ HDL_CHOLE_lt4050             : logi [1:2837] TRUE FALSE FALSE FALSE FALSE FALSE ...
#  $ WAIST_ge9080                 : logi [1:2837] TRUE FALSE TRUE TRUE FALSE FALSE ...
#  $ WAIST_ge9085                 : logi [1:2837] TRUE FALSE TRUE TRUE FALSE FALSE ...
#  $ BP_ge130_85                  : logi [1:2837] FALSE FALSE TRUE TRUE TRUE FALSE ...
#  $ nMetS_NoMeds_WAIST_ge9080    : int [1:2837] 4 1 3 3 1 0 2 0 2 0 ...
#  $ nMetS_NoMeds_WAIST_ge9080.ge3: logi [1:2837] TRUE FALSE TRUE TRUE FALSE FALSE ...
#  $ nMetS_NoMeds_WAIST_ge9085    : int [1:2837] 4 1 3 3 1 0 2 0 2 0 ...
#  $ nMetS_NoMeds_WAIST_ge9085.ge3: logi [1:2837] TRUE FALSE TRUE TRUE FALSE FALSE ...
```


