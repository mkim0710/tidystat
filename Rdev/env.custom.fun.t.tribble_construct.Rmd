---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 


#% env.custom$info$DocumentTitle1 ====
```{r}
# if(!exists("env.custom")) env.custom = new.env()
if(!exists("env.custom")) env.custom = list()
if(!exists("env.custom$info")) env.custom$info = list()
env.custom$info$DocumentTitle0 = "Blank) env.custom.fun.t.tribble_construct"
env.custom$info$DocumentTitle1 = paste0(env.custom$info$DocumentTitle0,"@", ifelse(grepl("MacBook-Pro", Sys.info()["nodename"]), "MBP", Sys.info()["nodename"]))
cat(env.custom$info$DocumentTitle1); cat("\r\n");
cat(env.custom$info$DocumentTitle1, ".R", sep = ""); cat("\r\n");
cat(env.custom$info$DocumentTitle1, " -dev.R", sep = ""); cat("\r\n");
cat(env.custom$info$DocumentTitle1, " -clean.R", sep = ""); cat("\r\n");
cat(env.custom$info$DocumentTitle1, ".RMD", sep = ""); cat("\r\n");
cat(env.custom$info$DocumentTitle1, " -dev.RMD", sep = ""); cat("\r\n");
cat(env.custom$info$DocumentTitle1, " -clean.RMD", sep = ""); cat("\r\n");
```

#% env.custom$info$info_system_info ====
```{r}
env.custom$info$get_system_info = function() {
    summary_list = list(
        GUI = .Platform$GUI,
        OS.type = .Platform$OS.type,
        OS.sysname = as.character(Sys.info()["sysname"]),
        OS.version = as.character(Sys.info()["version"]),
        machine.type = as.character(Sys.info()["machine"]),
        machine.nodename = as.character(Sys.info()["nodename"]),
        machine.CPU = if (.Platform$OS.type == "unix" & Sys.info()["sysname"] == "Darwin") 
            trimws(system("sysctl -n machdep.cpu.brand_string", intern=TRUE))
        else if (.Platform$OS.type == "unix" & Sys.info()["sysname"] == "Linux") 
            trimws(system("awk '/model name/' /proc/cpuinfo | uniq | awk -F': ' '{print $2}'", intern=TRUE))
        else if (.Platform$OS.type == "windows") 
            trimws(system("wmic cpu get name", intern=TRUE)[2])
        else NA,
        Sys.getlocale = list(
            LC_COLLATE = Sys.getlocale(category = "LC_COLLATE"), 
            LC_CTYPE = Sys.getlocale(category = "LC_CTYPE"), 
            LC_locale_NUMERIC = Sys.getlocale(category = "LC_NUMERIC"), 
            LC_locale_TIME = Sys.getlocale(category = "LC_TIME")
        ), 
        l10n_info = list(
            localization_UTF8 = l10n_info()$`UTF-8`,
            localization_Latin1 = l10n_info()$`Latin-1`,  
            localization_codeset = l10n_info()$codeset,
            localization_codepage = l10n_info()$codepage,
            localization_system.codepage = l10n_info()$system.codepage
        )
    )
}
env.custom$info$info_system_info = env.custom$info$get_system_info()
str(env.custom$info$info_system_info)
```



##@ASROCKX300RYZEN
List of 9
 $ GUI             : chr "RStudio"
 $ os_type         : chr "windows"
 $ os_sysname      : chr "Windows"
 $ os_version      : chr "build 22621"
 $ machine_type    : chr "x86-64"
 $ machine_nodename: chr "ASROCKX300RYZEN"
 $ machine_cpu     : chr "AMD Ryzen 5 5600G with Radeon Graphics"
 $ Sys.getlocale   :List of 4
  ..$ LC_COLLATE       : chr "Korean_Korea.utf8"
  ..$ LC_CTYPE         : chr "Korean_Korea.utf8"
  ..$ LC_locale_NUMERIC: chr "C"
  ..$ LC_locale_TIME   : chr "Korean_Korea.utf8"
 $ l10n_info       :List of 5
  ..$ localization_UTF8           : logi TRUE
  ..$ localization_Latin1         : logi FALSE
  ..$ localization_codeset        : NULL
  ..$ localization_codepage       : int 65001
  ..$ localization_system.codepage: int 65001
  
  
##@LIVAI7-8700
List of 9
 $ GUI             : chr "RStudio"
 $ os_type         : chr "windows"
 $ os_sysname      : chr "Windows"
 $ os_version      : chr "build 19045"
 $ machine_type    : chr "x86-64"
 $ machine_nodename: chr "LIVAI7-8700"
 $ machine_cpu     : chr "Intel(R) Core(TM) i7-8700 CPU @ 3.20GHz"
 $ Sys.getlocale   :List of 4
  ..$ LC_COLLATE       : chr "Korean_Korea.utf8"
  ..$ LC_CTYPE         : chr "Korean_Korea.utf8"
  ..$ LC_locale_NUMERIC: chr "C"
  ..$ LC_locale_TIME   : chr "Korean_Korea.utf8"
 $ l10n_info       :List of 5
  ..$ localization_UTF8           : logi TRUE
  ..$ localization_Latin1         : logi FALSE
  ..$ localization_codeset        : NULL
  ..$ localization_codepage       : int 65001
  ..$ localization_system.codepage: int 65001


##@Posit Cloud
List of 9
 $ GUI             : chr "RStudio"
 $ os_type         : chr "unix"
 $ os_sysname      : chr "Linux"
 $ os_version      : chr "#96~18.04.1-Ubuntu SMP Mon Oct 17 02:57:48 UTC 2022"
 $ machine_type    : chr "x86_64"
 $ machine_nodename: chr "application-9677950-deployment-19172365-82455"
 $ machine_cpu     : chr "AMD EPYC 7R13 Processor"
 $ Sys.getlocale   :List of 4
  ..$ LC_COLLATE       : chr "C.UTF-8"
  ..$ LC_CTYPE         : chr "C.UTF-8"
  ..$ LC_locale_NUMERIC: chr "C"
  ..$ LC_locale_TIME   : chr "C.UTF-8"
 $ l10n_info       :List of 5
  ..$ localization_UTF8           : logi TRUE
  ..$ localization_Latin1         : logi FALSE
  ..$ localization_codeset        : chr "UTF-8"
  ..$ localization_codepage       : NULL
  ..$ localization_system.codepage: NULL
  

#% env.custom$info$info_software_versions ====
```{r}
library(purrr)

env.custom$info$get_software_versions <- function(library_names = c("tidyverse", "dplyr", "ggplot2", "purrr", "stringr")) {
  version_list <- list(OS.type = .Platform$OS.type, R.version = R.version$version.string)
  version_list$RStudio_version <- ifelse(!is.null(.Platform$GUI) && .Platform$GUI == "RStudio" && exists("RStudio.Version"), RStudio.Version()$version, NA)
  version_list$library_versions <- setNames(map(library_names, function(lib) {
    if (!requireNamespace(lib, quietly = TRUE)) return(paste(lib, "not installed"))
    (packageVersion(lib))
  }), library_names)
  return(version_list)
}
env.custom$info$info_software_versions = env.custom$info$get_software_versions(
    library_names = c("tidyverse", "dplyr", "ggplot2", "purrr", "stringr",
                      "datapasta")
)
str(env.custom$info$info_software_versions)
# dput(env.custom$info$info_software_versions)

```

##@ASROCKX300RYZEN

##@LIVAI7-8700
##@Posit Cloud

################################################
#% env.custom$path$data_suffix ====
#% env.custom$path$project_suffix ====
```{r}
library(tidyverse); cat("\r\n"); 
cat("\r\n"); cat("getwd() == "); dput(getwd()) #----
env.custom$path$getwd = getwd()
env.custom$path$path0 = file.path("D:", "OneDrive - SNU", "[][Rproject]")
env.custom$path$project_base = "Rproject_HEALS0215"
env.custom$path$data_suffix = "_01"
# env.custom$path$data_suffix = ""
env.custom$path$project_suffix = "GJ3"


env.custom$path$path1 = file.path(env.custom$path$path0, paste0(env.custom$path$project_base, env.custom$path$data_suffix))
env.custom$path$path2 = file.path(env.custom$path$path1, paste0(env.custom$path$project_base, env.custom$path$data_suffix, env.custom$path$project_suffix))

path4read = env.custom$path$path1
# path4write = env.custom$path$path1
path4write = env.custom$path$path2
if (getwd() != path4read) warning("getwd() != path4read == ") else cat("getwd() == path4read == "); dput(path4read)  #----
if (getwd() != path4write) warning("getwd() != path4write  == ") else cat("getwd() == path4write == "); dput(path4write)  #----
```


#% env.custom$fun.path_files_size() ====
```{r}
# tribble_paste = datapasta::tribble_paste
# https://github.com/mkim0710/tidystat/blob/master/Rdev/env.custom.fun.t.tribble_construct.source.r
load(url("https://github.com/mkim0710/tidystat/raw/master/Rdev/env.custom.fun.t.tribble_construct.RData"))
# attach(env.custom)

# regex4filename = "\\.rds(\\.xz)?$"
regex4filename = "\\.rds\\.xz$"
list.files(path4read) %>% grep(regex4filename, ., value = T) %>% dput #----
env.custom$fun.path_files_size(path4read = path4read, regex4filename = regex4filename)

regex4filename = "\\.rds$"
list.files(path4read) %>% grep(regex4filename, ., value = T) %>% dput #----
env.custom$fun.path_files_size(path4read = path4read, regex4filename = regex4filename)
```


#@ assign(objectname, readRDS(file.path(path4read, filename2read))) 
```{r}
if (getwd() != path4read) warning("getwd() != path4read == ") else cat("getwd() == path4read == "); dput(path4read)  #----
objectname = "tblID_gj3_jk"
filename2read = if(file.exists(file.path(path4read, paste0(objectname, ".rds")))) paste0(objectname, ".rds") else paste0(objectname, ".rds.xz")
print(file.path(path4read, filename2read))
t0 = Sys.time()
assign(objectname, readRDS(file.path(path4read, filename2read)))
Sys.time() - t0
str(get(objectname), max.level = 1, give.attr = F)
```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```

#@@ END -----
#@ write_rds( get(objectname), file.path(path4write, paste0(objectname, ".rds"))) -----
```{r}
#@@ END -----
objectname = "AnalyticDataset200621"
write_rds( get(objectname), file.path(path4write, paste0(objectname, ".rds")))
# write_rds( get(objectname), file.path(path4write, paste0(objectname, ".rds")), compress = "gz" )
# write_rds( get(objectname), file.path(path4write, paste0(objectname, ".rds", "")), compress = "xz", compression = 9 )
# openxlsx::write.xlsx(get(objectname), file = paste0(objectname, ".xlsx"), asTable = T, withFilter = T)
# openxlsx::openXL(paste0(objectname, ".xlsx"))
```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
